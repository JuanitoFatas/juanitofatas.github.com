---
layout: post
title: "Common Lisp 浮点数的大小限制"
date: 2012-06-18 15:53
comments: true
categories: Lisp
tags: lisp
---

Common Lisp 有四种浮点数:

* short-float
* single-float
* double-float
* long-float

Common Lisp 用 16 个全局常量标明了每个浮点数的限制。它们的名字是这种形式: `m-s-f` ，其中 `m` 是 most 或 least ， `s` 是 positive 或 negative ，而 `f` 是四种浮点数之一，举个例子，most-positive-short-float。

找出 16 个全域常数：

```scheme
(defun float-limits ()
  (dolist (m '(most least))
    (dolist (s '(positive negative))
      (dolist (f '(short single double long))
        (let ((n (intern (string-upcase
                            (format nil "~A-~A-~A-float"
                                          m  s  f)))))
          (format t "~30A ~A ~%" n (symbol-value n)))))))
```

在各个实现中分别为:

### CCL 1.8

```scheme
MOST-POSITIVE-SHORT-FLOAT      3.4028235E+38
MOST-POSITIVE-SINGLE-FLOAT     3.4028235E+38
MOST-POSITIVE-DOUBLE-FLOAT     1.7976931348623157D+308
MOST-POSITIVE-LONG-FLOAT       1.7976931348623157D+308
MOST-NEGATIVE-SHORT-FLOAT      -3.4028235E+38
MOST-NEGATIVE-SINGLE-FLOAT     -3.4028235E+38
MOST-NEGATIVE-DOUBLE-FLOAT     -1.7976931348623157D+308
MOST-NEGATIVE-LONG-FLOAT       -1.7976931348623157D+308
LEAST-POSITIVE-SHORT-FLOAT     1.4012985E-45
LEAST-POSITIVE-SINGLE-FLOAT    1.4012985E-45
LEAST-POSITIVE-DOUBLE-FLOAT    5.0D-324
LEAST-POSITIVE-LONG-FLOAT      5.0D-324
LEAST-NEGATIVE-SHORT-FLOAT     -1.4012985E-45
LEAST-NEGATIVE-SINGLE-FLOAT    -1.4012985E-45
LEAST-NEGATIVE-DOUBLE-FLOAT    -5.0D-324
LEAST-NEGATIVE-LONG-FLOAT      -5.0D-324
```

## SBCL 1.0.55

```scheme
MOST-POSITIVE-SHORT-FLOAT      3.4028235e38
MOST-POSITIVE-SINGLE-FLOAT     3.4028235e38
MOST-POSITIVE-DOUBLE-FLOAT     1.7976931348623157d308
MOST-POSITIVE-LONG-FLOAT       1.7976931348623157d308
MOST-NEGATIVE-SHORT-FLOAT      -3.4028235e38
MOST-NEGATIVE-SINGLE-FLOAT     -3.4028235e38
MOST-NEGATIVE-DOUBLE-FLOAT     -1.7976931348623157d308
MOST-NEGATIVE-LONG-FLOAT       -1.7976931348623157d308
LEAST-POSITIVE-SHORT-FLOAT     1.4012985e-45
LEAST-POSITIVE-SINGLE-FLOAT    1.4012985e-45
LEAST-POSITIVE-DOUBLE-FLOAT    4.9406564584124654d-324
LEAST-POSITIVE-LONG-FLOAT      4.9406564584124654d-324
LEAST-NEGATIVE-SHORT-FLOAT     -1.4012985e-45
LEAST-NEGATIVE-SINGLE-FLOAT    -1.4012985e-45
LEAST-NEGATIVE-DOUBLE-FLOAT    -4.9406564584124654d-324
LEAST-NEGATIVE-LONG-FLOAT      -4.9406564584124654d-324
```

## LispWorks Personal 6.0.1

```scheme
MOST-POSITIVE-SHORT-FLOAT      3.4028172S38
MOST-POSITIVE-SINGLE-FLOAT     3.4028235E38
MOST-POSITIVE-DOUBLE-FLOAT     1.7976931348623158D308
MOST-POSITIVE-LONG-FLOAT       1.7976931348623158D308
MOST-NEGATIVE-SHORT-FLOAT      -3.4028172S38
MOST-NEGATIVE-SINGLE-FLOAT     -3.4028235E38
MOST-NEGATIVE-DOUBLE-FLOAT     -1.7976931348623158D308
MOST-NEGATIVE-LONG-FLOAT       -1.7976931348623158D308
LEAST-POSITIVE-SHORT-FLOAT     4.5S-44
LEAST-POSITIVE-SINGLE-FLOAT    2.0E-45
LEAST-POSITIVE-DOUBLE-FLOAT    5.0D-324
LEAST-POSITIVE-LONG-FLOAT      5.0D-324
LEAST-NEGATIVE-SHORT-FLOAT     -4.5S-44
LEAST-NEGATIVE-SINGLE-FLOAT    -2.0E-45
LEAST-NEGATIVE-DOUBLE-FLOAT    -5.0D-324
LEAST-NEGATIVE-LONG-FLOAT      -5.0D-324
```

参考 Ansi Common Lisp 第九章：数字。