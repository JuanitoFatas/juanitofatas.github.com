<!--
       _                   _ _          ______    _
      | |                 (_) |        |  ____|  | |
      | |_   _  __ _ _ __  _| |_ ___   | |__ __ _| |_ __ _ ___
  _   | | | | |/ _` | '_ \| | __/ _ \  |  __/ _` | __/ _` / __|
 | |__| | |_| | (_| | | | | | || (_) | | | | (_| | || (_| \__ \
  \____/ \__,_|\__,_|_| |_|_|\__\___/  |_|  \__,_|\__\__,_|___/
-->
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 2 頁 | 彙整 | I'm Juanito Fatas</title>
  <meta name="author" content="Juanito Fatas">
  
  <meta name="description" content="This site contains technical articles, presentations, thoughts, software, and other materials by Juanito Fatas.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="I'm Juanito Fatas"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="I'm Juanito Fatas" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
    <link rel="stylesheet" type="text/css" href="//cdn.moot.it/1/moot.css">
  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script>
  $(document).ready(function() {
    $('#sidebar').delay(400).animate({ width: '285px' }, 500, function() {
      $('.personal-info').css({display: 'table'}).hide().fadeIn(500);
    });
  });
  </script>
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-41041908-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>


<body>
  <header id="header" class="inner"><!-- <div class="alignleft">
  <h1><a href="/">I'm Juanito Fatas</a></h1>
  <h2><a href="/">C-x C-f...C-x C-s...</a></h2>
</div>
 --><!-- <nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首頁</a></li>
    
      <li><a href="/archives">彙整</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
 --></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignright"><div id="wrapper">
<h2 class="archive-title">彙整</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T17:04:00.000Z"><a href="/2012/05/18/2012-05-18-jquery-query-dom/">5月 18 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/18/2012-05-18-jquery-query-dom/">使用 jQuery 查询 DOM</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>哈罗，你又来看我文章了，谢谢，这篇讲的是巨基本的使用 jQuery 来查询 DOM。</p>
<p>给定一个 HTML：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="code"><pre><span class="doctype">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
true<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">utf-8</span>&gt;</span>
true<span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span>
true<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css">
<span class="tag">trueli</span> <span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value"> black }</span></span></span>
<span class="tag">true</span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>

<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container"</span>&gt;</span>
true<span class="tag">&lt;<span class="title">h1</span>&gt;</span>Welcome to My Website <span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
true<span class="tag">&lt;<span class="title">p</span>&gt;</span>
truetrueLorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
truetruetempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
truetruequis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
truetrueconsequat.
true<span class="tag">&lt;/<span class="title">p</span>&gt;</span>

true<span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"emphasis"</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>item 4<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>item 5<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>
truetruetrue<span class="tag">&lt;<span class="title">ul</span>&gt;</span>
truetruetruetrue<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello from the nest.<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
truetruetrue<span class="tag">&lt;/<span class="title">ul
truetrue&lt;</span>/<span class="attribute">li</span>&gt;</span>
true<span class="tag">&lt;/<span class="title">ul</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>

<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>

<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">

</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<p>型別</p>
<p>为了讲解方便，我直接使用 CDN 来引用 jQuery。之后讲述的代码请放在 <code>&lt;/body&gt;</code> 前面的 <code>&lt;script&gt;</code> 标签内。</p>
<p>OK! 开始！</p>
<h2>children() find() next() prev() first()</h2>
<p>假设今天我们想要选中类是 emphasis 的 <code>ul</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>);
</pre></td></tr></table></figure>

<p>上面这行：嘿，jQuery，帮我根据这个 CSS 选择器 <code>ul.emphasis</code> 去 DOM 把符合条件的找出来。</p>
<p>取出 <code>ul</code> 的第一个 <code>li</code> ，并添加绿色：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).css(<span class="string">'color'</span>, <span class="string">'green'</span>);
</pre></td></tr></table></figure>

<p>这等同于 CSS:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>ul.emphasis &gt; li { color: green; }
</pre></td></tr></table></figure>

<p><strong>注意</strong> 这个 <code>&gt;</code> 在这边起的作用，这说明了我们只选中第一阶层的小孩，direct children。</p>
<p>试试看这个代码</p>
<p>你会发现嵌套的那个 ul li 是黑色，不是绿色。这样应该明白 direct children 了吧。</p>
<p>你也可以使用 jQuery 的 <code>find</code> 来找到：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).find(<span class="string">'li'</span>).css(<span class="string">'color'</span>, <span class="string">'green'</span>);
</pre></td></tr></table></figure>

<p>但要注意的是，这会从 <code>ul.emphasis</code> 搜寻所有的 li (all descendent)，等同于 CSS 的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>ul.emphasis li { color: green; }
</pre></td></tr></table></figure>

<p>好，现在我们在 <code>style</code> 标签内添加一个样式：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>.emphasis { color: green; }
</pre></td></tr></table></figure>

<p>并移除刚刚那行代码。</p>
<p>现在我们想替 <code>ul.emphasis</code> 的第一个 <code>li</code> 加上类名的办法来上色，该怎么做呢？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:nth-child(1)'</span>).addClass(<span class="string">'emphasis'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).find(<span class="string">'li:nth-child(1)'</span>).addClass(<span class="string">'emphasis'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>你可能会说，干嘛不用 CSS 就好了，因为使用 jQuery 的话，这些新潮的 CSS3 选择器可以支援 IE6+。</p>
<p>都是万恶的 IE 害的，呜呜。。。</p>
<p>注意这行代码内的选择器：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>不是 CSS 的选择器，而是 jQuery 提供的 Helper。如果有自带的 CSS 选择器可用的话，就使用 CSS 选择器，再来才是使用 jQuery 提供的 Helper。因为这比使用 jQuery 提供的来得快一点点。</p>
<p>刚刚那行代码，使用 CSS 有的选择器：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>好，那 jQuery 还有别的方法可用吗，有：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).first().addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>我们用了一个 jQuery 提供的 <code>first()</code>，作用一样。</p>
<p>那想选中第二个 <code>li</code> (item2) 呢，并把文字改为 Hello from jQuery？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:nth-child(2)'</span>).text(<span class="string">'Hello from jQuery'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>注意到，<code>eq(1)</code>，因为 Javascript 跟大多数程序语言一样是 <strong>零索引的</strong> ，从零开始数。</p>
<p>好如果我想要先选中 item2，再往后一个，该怎么写呢：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>这串长不拉机的东东有个术语叫做 <em>chaining</em> ，它能这么干的原因是每一个调用都返回一个 jQuery 对象。</p>
<p>但是别 chian 的太长了。</p>
<p>有 <code>next()</code> 也有 <code>prev()</code> 。</p>
<p>一个要写出 jQuery 的秘诀是写之前先念一遍，再直观地写出来，大部分都是对的哈哈。</p>
<p>不过这个贼长的 jQuery 你一般都会写成：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);
<span class="comment">// better</span>
$(<span class="string">'ul.emphasis li:nth-child(2)'</span>).text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>chaining 比较慢，代码也比较长，但你还是会需要动态地使用 chaining。</p>
<p>这么长的代码也可以这样缩排：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);

<span class="comment">// 等同于</span>
$(<span class="string">'ul.emphasis'</span>)
truetrue.children(<span class="string">'li'</span>)
truetruetrue.eq(<span class="number">1</span>)
truetruetrue.next().text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<h2>parent() parents() closest()</h2>
<p>HTML 实际上就是一个语法树，不懂语法树就想成家庭树，有爷爷奶奶老爸老妈儿子女儿孙子孙女。</p>
<p>好，看个例子，今天我们想要移除 <code>li</code> 的父节点的类别</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent().removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>也可以显式指定要找的 parent 的类型：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent(<span class="string">'ul'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>你可以使用浏览器的开发工具查看源代码来检查是否移除成功。</p>
<p>现在让我们加入一个新样式：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>.container { color: green; }
</pre></td></tr></table></figure>

<p>刷新页面，整面绿油油。如果我不想要整片绿油油，我想要移除 parent 的类：container，</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent(<span class="string">'.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>刷新页面，擦，没作用，这是因为这跟 direct children 一样，只会找到上一层的 parent，如果我把 parent 换成：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parents(<span class="string">'.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>注意那个 <strong>s</strong> ，这样就会像 <code>find</code> 一样，一直往上找。</p>
<p>你也可以更具体的说，你要移除的是这个 <code>div.container</code> 元素:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parents(<span class="string">'div.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>而这行代码等同于：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).closest(<span class="string">'div.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>让我们到 <a href="http://api.jquery.com/" target="_blank">http://api.jquery.com/</a> 查查这个函数是干嘛使的。</p>
<h2>.closest()</h2>
<blockquote>
<p>Get the first element that matches the selector, beginning at the current element and progressing up through the DOM tree.</p>
</blockquote>
<p>我们这个例子是，从 <code>$(li)</code> 开始往上爬 DOM 树，寻找第一个匹配 <code>(&#39;div.container&#39;)</code> 的元素。</p>
<h2>.removeClass()</h2>
<blockquote>
<p>Remove a single class, multiple classes, or all classes from each element in the set of matched elements.</p>
</blockquote>
<p>移除匹配元素集合中的每一个元素的单一、多个或整个类别。</p>
<h2>parents() 与 closest() 的差异？</h2>
<p>其实是一个微妙的差异，你可以研读一下 API，或是这次我直接跟你说了吧：</p>
<p><code>parents()</code> 会根据选择器条件，往上爬树，找出所有符合的。</p>
<p><code>closest()</code> 只会根据选择器条件，找到最近符合的那一个。</p>
<p>查询 API 与源代码是学习 jQuery 的不二法门。</p>
<p>本篇结束。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T16:31:00.000Z"><a href="/2012/05/18/2012-05-18-jquery-intro-2/">5月 18 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/18/2012-05-18-jquery-intro-2/">jQuery 1.7 介绍（下）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>建议不要看我写的文章，赶快到这里学会时下最火最流行的 jQuery!</p>
<p><a href="http://tutsplus.com/course/30-days-to-learn-jquery/" target="_blank">30 天学会 jQuery</a></p>
<h2>＄号</h2>
<p>我希望你还记得 <code>$</code> 号是什么：</p>
<p>型別</p>
<pre><code>window<span class="preprocessor">.jQuery</span> = window.$ = jQuery<span class="comment">;</span></code></pre>
<p>拿来引用 jQuery 函数的快捷方式。</p>
<p>首先讲 jQuery 之前，假定我们有一个 HTML 文件：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="doctype">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
true<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">utf-8</span>&gt;</span>
true<span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span>
true<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css">
<span class="tag">true</span><span class="class">.emphasis</span> <span class="rules">{ <span class="rule"><span class="attribute">font-weight</span>:<span class="value"> bold;</span></span><span class="rule">}</span></span>
<span class="tag">true</span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
true<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
true<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">

<span class="literal">true</span></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
<span class="tag">&lt;<span class="title">ul</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello 2<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello 3<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span>

<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<p>下面讲述的代码请填入 <code>&lt;/head&gt;</code> 上方的 script 标签内。</p>
<p>OK. 开始。</p>
<p>假设我们要取得 <code>ul</code> 的第一个 <code>li</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>打开你的浏览器看看，干，怎么不行，这是因为。。。</p>
<p>你的代码放在 head 标签内，下面的 HTML 都还没有载入完毕 (DOM)，就执行了这行代码，执行代码的时候，这会儿根本还没有看到 ul li 呢。</p>
<p>你可以把 <code>&lt;script&gt; ... &lt;/script&gt;</code> 搬到 <code>&lt;/body&gt;</code> 上方，这样就可以了。要是你很坚持你的代码要放在 head 标签内，没问题，使用 jQuery 的 ready 函数：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> foo = <span class="keyword">function</span>() {};
$(document).ready(foo);
</pre></td></tr></table></figure>

<p><code>$(document)</code> 叫 jQuery 去把 DOM 抓出来。</p>
<p>等到 document 载入完毕，准备好要给我们玩弄的时候，执行 <code>ready</code> 函数内的 <code>foo</code> 函数。</p>
<p>更简洁的写法、传入匿名函数、或叫回呼函数 (callback function)：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {

});
</pre></td></tr></table></figure>

<p>接下来在这个匿名函数内放入我们之前想做的事儿：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {
truetrue$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>这个 ready 函数会大概每 10 ms 去检查 DOM 准备好给我们玩弄了没，准备好了就执行里面的函数。</p>
<p>把 <code>$(document).ready()</code> 变得更简洁一点：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>好了，好奇的你又问了，这是为什么？</p>
<p>请看 <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js" target="_blank">jQuery 源代码</a>，搜索这个关键字 <code>jQuery.fn = jQuery.prototype = {</code></p>
<p>这下面一整段代码，说明了我们调用 jQuery 函数 <code>$()</code> 时，碰到选择器、函数、上下文时该怎么处理。</p>
<p>好，我们现在是传入了一个函数：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>看到没有，<code>$( function() { ... } )</code>，我们来找找处理传入函数的源代码，一直往下找：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">// HANDLE: $(function)</span>
<span class="comment">// Shortcut for document ready</span>
} <span class="keyword">else</span> <span class="keyword">if</span> ( jQuery.isFunction( selector ) ) {
truereturn rootjQuery.ready( selector );
}
</pre></td></tr></table></figure>

<p>阿哈，这里写的明明白白，document ready 的缩写。</p>
<p>这里的 <code>selector</code> 就是我们所传入的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
}
</pre></td></tr></table></figure>

<p>而它说:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">if</span> ( jQuery.isFunction( selector ) ) {
truereturn rootjQuery.ready( selector );
}
</pre></td></tr></table></figure>

<p>如果传入的 <code>selector</code> 是函数的话，返回 <code>rootjQuery.ready( selector );</code></p>
<p>呵呵。。。所以这两段代码是等效的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});

$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>很多人觉得使用第二种这个缩写不太好，第一种的可读性比较高，这是你个人的选择，如果你知道你在干什么，两个都很好。</p>
<p>本篇结束。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T15:43:00.000Z"><a href="/2012/05/17/2012-05-17-jquery-intro/">5月 17 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/17/2012-05-17-jquery-intro/">jQuery 1.7 介绍（上）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>建议不要看我写的文章，赶快到这里学会时下最火最流行的 jQuery!</p>
<p><a href="http://tutsplus.com/course/30-days-to-learn-jquery/" target="_blank">30 天学会 jQuery</a></p>
<h2>神马是 jQuery？</h2>
<p>地球上最受欢迎的 Javascript 函式库、软件攻城狮必备技能之一、网页看起来美妙的魔法之一。</p>
<p>2012.05.17 现在的版本是 1.7.2。</p>
<p>型別</p>
<h2>去哪里获得 jQuery</h2>
<p>通常有开发版本与生产版本 <strong>32KB</strong> ，建议本地开发使用开发版本 <strong>247KB</strong> ，使用 jQuery 时顺便研读源代码。</p>
<blockquote>
<p>开发版本：无压缩、带注释；生产版本：压缩过、不堪入目。</p>
</blockquote>
<p><a href="http://jquery.com/" target="_blank">jQuery 官网</a></p>
<p>jQuery CDN: <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js" target="_blank">1.7.2 development</a> <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" target="_blank">1.7.2 production</a></p>
<blockquote>
<p>不建议使用 CDN，可以参考我的不要使用 CDN 来放第三方 Javascript</p>
</blockquote>
<h2>怎么在 HTML 里面玩弄 Javascript 代码</h2>
<p>把 JS 代码放在 script 标签内即可。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>&lt;script&gt;

<span class="xml"><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span>
</pre></td></tr></table></figure>

<h2>如何引用 jQuery 至你的 HTML</h2>
<p>假设我有一个 app 目录，下面有一个 js 文件夹、一个 index.html，js 目录下有一个 jquery-1.7.1.js。</p>
<p>使用 script 标签引用：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/jquery-1.7.1.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
</pre></td></tr></table></figure>

<p>使用 CDN 引用：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
</pre></td></tr></table></figure>

<p><strong>建议摆放位置</strong> <code>&lt;/body&gt;</code> 标签的正上方。</p>
<p>理由：浏览器一旦碰到 script 得载入完或下载完才会继续往下载入，所以放在 <code>&lt;/body&gt;</code> 上方可以确保你的页面先载入 HTML 以及 CSS。</p>
<h2>第一个 jQuery 代码</h2>
<h3>如何引用 jQuery?</h3>
<p>jQuery 其实就是一个函数，你可以这样子引用它：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(...)
</pre></td></tr></table></figure>

<p>好，让我们看看怎么让 jQuery 玩弄页面的 CSS。</p>
<p>假设我们有一个 HTML 页面:</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="doctype">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
true<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">utf-8</span>&gt;</span>
true<span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span>
true<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css">
<span class="tag">true</span><span class="class">.emphasis</span><span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value"> green;</span></span> <span class="rule">}</span></span>
<span class="tag">true</span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
<span class="tag">&lt;<span class="title">ul</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello 2<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
true<span class="tag">&lt;<span class="title">li</span>&gt;</span>hello 3<span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/jquery-1.7.1.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">

</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<p>以下代码添加至 <code>&lt;/body&gt;</code> 上方的 script 标签。</p>
<p>要怎么样用 jQuery 来添加 CSS 样式？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>);
</pre></td></tr></table></figure>

<p>这一行的作用是，你跟 jQuery 说，帮我根据这个 CSS 选择器搜寻一下 DOM。</p>
<p>存到一个变量里，并打印到浏览器的 console 看看：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> lis = jQuery(<span class="string">'ul li'</span>);
console.log(lis);
</pre></td></tr></table></figure>

<p>阿哈，你打开浏览器、打开开发者工具，切换到 console tab，会看到</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>[<span class="xml"><span class="tag">&lt;<span class="title">li</span>&gt;</span>​hello​<span class="tag">&lt;/<span class="title">li</span>&gt;</span>​, <span class="tag">&lt;<span class="title">li</span>&gt;</span>​hello 2​<span class="tag">&lt;/<span class="title">li</span>&gt;</span>​, <span class="tag">&lt;<span class="title">li</span>&gt;</span>​hello 3​<span class="tag">&lt;/<span class="title">li</span>&gt;</span>​]</span>
</pre></td></tr></table></figure>

<p><code>console.log()</code> 可以当之后调试代码的手段之一。</p>
<p>猛阿，基本上只要懂 CSS 选择器，jQuery 几乎都学会了！呵呵。。。</p>
<p>再举个例子，怎么给这些清单元素添加红色呢？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).css(<span class="string">'color'</span>,<span class="string">'red'</span>);
</pre></td></tr></table></figure>

<blockquote>
<p>尽量把所有的样式交给 CSS 来做，你偶尔才会需要用到 jQuery 来更改样式。</p>
</blockquote>
<p>另一个例子，给这些清单元素添加 <code>style</code> 标签内的 <code>.emphasis</code> 这个类：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<h3>使用缩写引用 jQuery</h3>
<p>这一行</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p>等同于</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p>等同于</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>window.jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p><strong>你怎么知道的！？</strong></p>
<p>请看 <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js" target="_blank">jQuery 源代码</a>的最下方：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">// Expose jQuery to the global object</span>
window.jQuery = window.$ = jQuery;
</pre></td></tr></table></figure>

<p>呵呵，人家都写在那呢。</p>
<p>这篇就介绍到这儿吧。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T14:06:00.000Z"><a href="/2012/05/17/2012-05-17-parse-xml-json/">5月 17 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/17/2012-05-17-parse-xml-json/">Python 简易解析 XML JSON</a></h1>
  

    </header>
    <div class="entry depth">
      
        <h3>XML</h3>
<h4>使用轻量快速的 minidom 函式库</h4>
<p>引用 minidom:</p>
<pre><code><span class="title">from</span> xml.dom <span class="import"><span class="keyword">import</span> minidom</span></code></pre>
<blockquote>
<p>DOM — Document Object Model</p>
</blockquote>
<p>minidom 有一个 parseString 函数可以解析 XML 字串。</p>
<p>型別</p>
<p>解析一个随意取名的 XML 字串，存入 x：</p>
<pre><code>x = minidom.parseString("<span class="tag">&lt;<span class="title">foo</span>&gt;</span>Lorem ipsum<span class="tag">&lt;<span class="title">children</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>1<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>2<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>3<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;/<span class="title">children</span>&gt;</span><span class="tag">&lt;/<span class="title">foo</span>&gt;</span>")</code></pre>
<p>x 现在是一个 xml.dom.minidom.Document instance 实例。</p>
<p><strong>注意</strong> XML 不像 HTML，严格要求每个 open 标签要有一个相应的 close 标签！</p>
<p>看看 x 有什么可以调用的属性、方法：</p>
<pre><code><span class="function"><span class="title">dir</span><span class="params">(x)</span>

[<span class="title">'ATTRIBUTE_NODE'</span>, <span class="title">'CDATA_SECTION_NODE'</span>, <span class="title">'COMMENT_NODE'</span>, <span class="title">'DOCUMENT_FRAGMENT_NODE'</span>, <span class="title">'DOCUMENT_NODE'</span>, <span class="title">'DOCUMENT_TYPE_NODE'</span>, <span class="title">'ELEMENT_NODE'</span>, <span class="title">'ENTITY_NODE'</span>, <span class="title">'ENTITY_REFERENCE_NODE'</span>, <span class="title">'NOTATION_NODE'</span>, <span class="title">'PROCESSING_INSTRUCTION_NODE'</span>, <span class="title">'TEXT_NODE'</span>, <span class="title">'__doc__'</span>, <span class="title">'__init__'</span>, <span class="title">'__module__'</span>, <span class="title">'__nonzero__'</span>, <span class="title">'_call_user_data_handler'</span>, <span class="title">'_child_node_types'</span> ... <span class="title">'standalone'</span>, <span class="title">'strictErrorChecking'</span>, <span class="title">'toprettyxml'</span>, <span class="title">'toxml'</span>, <span class="title">'unlink'</span>, <span class="title">'version'</span>, <span class="title">'writexml'</span>]</code></pre>
<p>转回 xml:</p>
<pre><code><span class="attribute">x.toprettyxml()</code></pre>
<p>印出来看看：</p>
<pre><code><span class="title">print</span> x.toprettyxml()</code></pre>
<p>输出：</p>
<pre><code><span class="tag">&lt;<span class="title">foo</span>&gt;</span>
    Lorem ipsum
    <span class="tag">&lt;<span class="title">children</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            1
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            2
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            3
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">children</span>&gt;</span>
<span class="tag">&lt;/<span class="title">foo</span>&gt;</span></code></pre>
<p>取得第二个 item 标签内的值 2：</p>
<pre><code><span class="transposed_variable">x.</span>getElementsByTagName(<span class="string">'item'</span>)<span class="matrix">[<span class="number">1</span>].</span>childNodes<span class="matrix">[<span class="number">0</span>].</span>nodeValue</code></pre>
<p>你可以看看 dir 里面有什么函数可以用，在 python 的直译器里面玩玩看。</p>
<h3>RSS</h3>
<p>比如说想要知道 <a href="http://www.nytimes.com/services/xml/rss/nyt/Science.xml" target="_blank">http://www.nytimes.com/services/xml/rss/nyt/Science.xml</a> 有几个 item：</p>
<pre><code><span class="title">from</span> xml.dom <span class="import"><span class="keyword">import</span> minidom</span>

<span class="import"><span class="keyword">import</span> urllib2</span>

<span class="title">contents</span> = urllib2.urlopen(<span class="string">"http://www.nytimes.com/services/xml/rss/nyt/Science.xml"</span>).read()

<span class="title">d</span> = minidom.parseString(contents)

<span class="title">len</span>(d.getElementsByTagName(<span class="string">"item"</span>)) # =&gt; <span class="number">38</span> on <span class="number">2012.05</span><span class="number">.17</span></code></pre>
<h3>JSON</h3>
<p>Javascript Object Notation</p>
<p>在 Python 用 dictionary 混 List 的形式储存 <code>{ foo: [{&quot;a&quot;: 1}, ... {&quot;c&quot;: 3}] }</code></p>
<p>使用 JSON 库：</p>
<pre><code><span class="import"><span class="keyword">import</span> json</span></code></pre>
<p>假设今天我们有一个 json 格式的字串 j，具有两个键 <code>mon</code> 与 <code>numbers</code>：</p>
<pre><code><span class="setting">j = <span class="value">'{<span class="string">"mon"</span>: <span class="number">1</span>, <span class="string">"numbers"</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">9.9</span>]}'</span></span></code></pre>
<p>载入这个 json ，存到 d 里：</p>
<pre><code><span class="setting">d = <span class="value">json.loads(j)</span></span></code></pre>
<p>载入后我们得到一个 python 字典（无序）：</p>
<pre><code>{<span class="string">u'mon'</span>: <span class="number">1</span>, <span class="string">u'numbers'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">9.9</span>]}</code></pre>
<p>取出 <code>mon</code> 的值：</p>
<pre><code>d[<span class="string">'mon'</span>] <span class="comment"># =&gt; 1</span>
d[<span class="string">'numbers'</span>][2] <span class="comment"># =&gt; 9.9</span></code></pre>
<p>你也可以 <code>eval</code> 这个 json 格式的字串：</p>
<pre><code><span class="keyword">eval</span>(j)
<span class="comment"># =&gt; {'mon': 1, 'numbers': [1, 2, 9.9]}</span></code></pre>
<p><strong>永远别用 eval 来解析 json</strong> 。</p>
<p>Q: 加总 www.reddit.com 帖子的 up votes。</p>
<p>A:</p>
<figure class="highlight lang-python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre>r = urllib2.urlopen(<span class="string">"http://www.reddit.com/.json"</span>)
j = json.loads(r)

j.keys() <span class="comment"># =&gt; [u'kind', u'data']</span>
j[<span class="string">'data'</span>].keys() <span class="comment"># =&gt; [u'modhash', u'children', u'after', u'before']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>].keys() <span class="comment"># =&gt; [u'kind', u'data']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'data'</span>].keys() <span class="comment"># =&gt; [..., u'ups']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'data'</span>][<span class="string">'ups'</span>] <span class="comment"># =&gt; 7902</span>

sum(c[<span class="string">'data'</span>][<span class="string">'ups'</span>] <span class="keyword">for</span> c <span class="keyword">in</span> j[<span class="string">'data'</span>][<span class="string">'children'</span>]) <span class="comment"># =&gt; 84500</span>
</pre></td></tr></table></figure>

<p>DONE.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-12T15:04:00.000Z"><a href="/2012/05/12/2012-05-12-nth-child-common-gotcha/">5月 12 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/12/2012-05-12-nth-child-common-gotcha/">CSS 一个常见 nth-child 的误区</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>给定有如下的 HTML 代码片段：</p>
<p>型別</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">html</span>&gt;</span>
...
<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="undefined">
truedt {
truetrueboder-top: 1px solid white;
truetrueboder-bottom: 1px solid gray;
true}
</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
true<span class="tag">&lt;<span class="title">dl</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dt</span>&gt;</span>How to install<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dd</span>&gt;</span>Check ...<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dt</span>&gt;</span>How to install<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dd</span>&gt;</span>Check ...<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dt</span>&gt;</span>How to install<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dd</span>&gt;</span>Check ...<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dt</span>&gt;</span>How to install<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dd</span>&gt;</span>Check ...<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dt</span>&gt;</span>How to install<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
truetrue<span class="tag">&lt;<span class="title">dd</span>&gt;</span>last ...<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
true<span class="tag">&lt;/<span class="title">dl</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<p>假设这是一个 FAQ，我们有一个 Definition list (<code>dl</code>)，并有五个 item (<code>dt</code>)，五个 item 描述 (<code>dd</code>)，</p>
<p>每个 <code>dt</code> 的上下有边界，分别是白色、黑色。</p>
<p>今天假如我们想要第一个 <code>dt</code> 上方没有 boder，以及最后一个 <code>dt</code> 下方没有 boder，这时候 CSS 该怎么写呢？</p>
<p>我们可以使用 CSS3 的 <code>first-child</code>：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:first-child</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-top</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span></code></pre>
<p>现在你可能会想要使用 <code>last-child</code> 来把 最后一个 dd 的 boder-bottom 拿掉：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:last-child</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span></code></pre>
<p>而这样不行，因为 <code>last-child</code> 是选择 parent 的最后一个 child，这个例子里会选中：</p>
<pre><code>&lt;dd&gt;last <span class="keyword">...</span>&lt;/dd&gt;</code></pre>
<p>那该怎么办呢？可以使用 <code>nth-last-child</code> ：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:nth-last-child(2)</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span></code></pre>
<p>这样子会从 <code>dl</code> 的最后一个 child 开始往上 2 个，也就是我们想要的最后一个 <code>dt</code>。</p>
<p>That&#39;s it!!!</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-12T09:33:00.000Z"><a href="/2012/05/12/2012-05-12-dont-use-cdn-html5shiv/">5月 12 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/12/2012-05-12-dont-use-cdn-html5shiv/">不要使用 CDN 来放第三方 Javascript</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p><a href="http://code.google.com/p/html5shiv/" target="_blank">HTML5shiv</a> 是一个让 IE 8 启用 HTML5 元素的第三方 JS，通常 CDN 引用的链接是：</p>
<p><a href="http://html5shiv.googlecode.com/svn/trunk/html5.js" target="_blank">http://html5shiv.googlecode.com/svn/trunk/html5.js</a></p>
<p>不要这么做的理由：</p>
<p>型別</p>
<ol>
<li><p>没有使用 HTTP 压缩</p>
</li>
<li><p>没有 cached，通常这个文件只缓存 180 秒。</p>
</li>
<li><p>googlecode.com 不支援 partial response (可以提高效能的东东)</p>
</li>
<li><p>你连到别人的地方，无法控制什么事情会发生，说不定那哥儿们不爽了直接删掉。。。</p>
</li>
<li><p>实际上压缩后才 1200 Bytes，造成很多额外的 Overhead (DNS lookup, TCP handshake…etc.)</p>
</li>
</ol>
<p>原始文章：<a href="http://zoompf.com/blog/2012/05/html5shiv-and-serving-content-from-code-repositories" target="_blank">html5shiv and Serving Content From Code Repositories</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-10T14:35:00.000Z"><a href="/2012/05/10/2012-05-10-python-zebra/">5月 10 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/10/2012-05-10-python-zebra/">Python 解决 Zebra 谜题</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>爱因斯坦养鱼问题的学名就叫 Zebra Puzzle。之所以叫爱因斯坦养鱼问题是为了刊登在杂志上吸引读者的注意，其实这个问题不是爱因斯坦搞的…</p>
<p>问题可以到这里看：<a href="http://en.wikipedia.org/wiki/Zebra_Puzzle" target="_blank">Zebra Puzzle</a></p>
<p>型別</p>
<p>首先实现了 2 个 小函数，<code>imright</code> 跟 <code>nextto</code></p>
<p>确定某房是不是在某房右边、或是两个房挨著。</p>
<p>接下来给每个房子编上号，12345，</p>
<p>然后使用了 Python 自带的排列工具 <code>itertools.permutations</code> 给出房子可能的排列。</p>
<p>接著用了一个 Python 的奇技淫巧，叫做 Generator Expression，</p>
<p>语法是：<code>(term for- 子句 (选择性) for-if- 子句)</code></p>
<p>这个 generator expression 会返回一个 Generator 对象。</p>
<p>恩，给个例子好了：</p>
<p>先定义一个算平方的函数，然后用 Generator Expression：</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">sqr</span><span class="params">(x)</span>:</span> <span class="keyword">print</span> <span class="string">' 调用 sqr, 参数 '</span>, x; <span class="keyword">return</span> x*x

g = (sq(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> x%<span class="number">2</span>==<span class="number">0</span>)</code></pre>
<p>这个时候如果调用 g ：</p>
<pre><code>&gt;&gt;&gt; <span class="comment">g</span>
&lt;<span class="comment">GeneratorObject</span> <span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>&gt;</code></pre>
<p>不会去调用函数，只返回一个 Generator 对象、然而</p>
<pre><code>&gt;&gt;&gt; <span class="keyword">next</span>(g)
调用 <span class="built_in">sqr</span>, 参数 <span class="number">0</span>
<span class="number">0</span></code></pre>
<p>才会调用这个 Generator 所绑定的函数。。。汗。。。</p>
<p>这个问题要找，水在哪个房子被喝的，哪个房子养斑马。</p>
<p>藉由把 Constraint 移到对的地方，减少需要的计算，再搭配 Generator-exp 的特性，最后大概 0.00028 秒之类的就算好了，<br>本来用 嵌套 For-loop 要算 1 小时。</p>
<p>至于那个 c 函数 是拿来显示统计数据跟除错用的。</p>
<p>完整代码：</p>
<script src="https://gist.github.com/2653290.js"></script>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-10T14:09:00.000Z"><a href="/2012/05/10/2012-05-10-python-for-inside/">5月 10 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/10/2012-05-10-python-for-inside/">Python For 循环的迭代器实现</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>给定一段 Python 代码：</p>
<pre><code><span class="keyword">for</span> x <span class="keyword">in</span> items:
    <span class="built_in">print</span> x</code></pre>
<p>这个 items 可以是字串、列表、等等，这种可以迭代的集合称之为 iterable。</p>
<p>型別</p>
<p>这个 iter 就是创一个迭代器出来，相信有学过 Java 的人都不陌生。</p>
<p>然后用一个 <code>try .. except</code> 语句包住，迭代至停为止，停时会抛出 StopIteration。</p>
<p>实际上是这样实现的：</p>
<pre><code>it = iter(items)
<span class="keyword">try</span>:
    <span class="keyword">while</span> <span class="built_in">True</span>
        x = next(it)
        <span class="keyword">print</span> x
<span class="keyword">except</span> StopIteration:
    <span class="keyword">pass</span></code></pre>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-04-30T16:51:00.000Z"><a href="/2012/05/01/2012-05-01-mac-install-growlnotify/">5月 1 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/01/2012-05-01-mac-install-growlnotify/">Homebrew Install growlnotify on Snow Leopard and Lion</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>Currently homebrew already removed formula of growlnotify. If you want to use the Gem <a href="http://rubygems.org/gems/growl" target="_blank">growl</a> with a well-known app growlnotify and you may encounter this error with Growlnotify on Snow Leopard:</p>
<pre><code>dyld: Symbol <span class="keyword">not</span> found: _kSecRandomDefault
  Referenced from: <span class="regexp">/usr/local/bin/g</span>rowlnotify
  Expected <span class="keyword">in</span>: <span class="regexp">/System/Library/Frameworks/Security.framework/Versions/A/</span>Security
 <span class="keyword">in</span> <span class="regexp">/usr/local/bin/g</span>rowlnotify
Trace/BPT trap</code></pre>
<p>型別</p>
<p>Here are the formulas:</p>
<h3>For Snow Leopard with growlnotify v1.2.2</h3>
<pre><code>brew install https://raw<span class="preprocessor">.github</span><span class="preprocessor">.com</span>/mxcl/homebrew/bd40f1e5f89fad962b021c827d56a9fdea0c847d/Library/Formula/growlnotify<span class="preprocessor">.rb</span></code></pre>
<h3>For Lion with growlnotify v1.3</h3>
<pre><code>brew install https://raw<span class="preprocessor">.github</span><span class="preprocessor">.com</span>/mxcl/homebrew/<span class="number">15</span>d6da0023924969fa6ad8a7cf743c4b39838e6e/Library/Formula/growlnotify<span class="preprocessor">.rb</span></code></pre>
<p>Alternatively you could try on their <a href="http://growl.info/downloads" target="_blank">offical download page</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-04-30T05:46:00.000Z"><a href="/2012/04/30/2012-04-30-sprok-guard-rspec/">4月 30 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/04/30/2012-04-30-sprok-guard-rspec/">Rails 3.2.3 使用 Spork + Guard + RSpec + Capybara</a></h1>
  

    </header>
    <div class="entry depth">
      
        <h2>比较匆忙的同学请看</h2>
<p>0) <code>rails new appname --skip-test-unit --skip-bundle</code></p>
<p>1) 复制这个 Gemfile(<a href="https://gist.github.com/2555402" target="_blank">OSX</a> / <a href="https://gist.github.com/2555397" target="_blank">Linux</a> / <a href="https://gist.github.com/2555403" target="_blank">Windows</a>)，替换掉项目下的 Gemfile。</p>
<p>安装需要的 Gems，你有两个选择：</p>
<p>2-a) <code>bundle install</code> ，之后使用 <code>bundle exec xxx</code><br>2-b) <code>bundle install --binstubs</code>  ，之后使用 <code>bin/xxx</code></p>
<p>3) <code>rails g rspec:install</code></p>
<p>4) 运行 <code>bin/guard init rspec &amp;&amp; bin/guard init spork</code><br>5) 复制这个 <a href="https://gist.github.com/2555614" target="_blank">Guardfile</a>，覆盖掉项目下的 Guardfile。<br>6) 添加 <code>--drb</code> 至项目的根目录下的 <code>.rspec</code>。<br>7) 复制这个 <a href="https://gist.github.com/2555618" target="_blank">spec/spec_helper.rb</a>，覆盖 <code>spec/spec_helper.rb</code>  </p>
<p>8-a) <code>bundle exec spork --bootstrap</code><br>8-b) <code>bin/sprok --bootstrap</code>  </p>
<p>9-a) <code>bundle exec guard</code><br>9-b) <code>bin/guard</code>  </p>
<p>型別</p>
<h2>有 10 分钟的同学请看</h2>
<h3>为什么使用 <a href="http://rubygems.org/gems/guard" target="_blank">Guard</a>？</h3>
<ol>
<li>要切回终端机敲 rspec 命令  </li>
<li>启动速度太慢 (使用 Spork 来加速)</li>
</ol>
<p>Guard 人如其名，自动侦测改动并运行测试。</p>
<h4>配置 Guard</h4>
<p>Gemfile:</p>
<p>在 <code>:development group</code> 加入：  </p>
<pre><code><span class="title">gem</span> <span class="string">'guard-rspec'</span>, <span class="string">'0.5.5'</span></code></pre>
<p>在 <code>:test group</code> 加入一些相依的 Gems，OSX 可能还需要安装 <a href="http://growl.info/downloads#generaldownloads" target="_blank">growl-notify</a>：</p>
<p><strong>MacOSX</strong></p>
<pre><code>gem <span class="string">'rb-fsevent'</span>, <span class="string">'0.4.3.1'</span>, :<span class="keyword">require</span> =&gt; <span class="keyword">false</span>
gem <span class="string">'growl'</span>, <span class="string">'1.0.3'</span></code></pre>
<p><strong>Linux</strong></p>
<pre><code><span class="title">gem</span><span class="string"> 'rb-inotify'</span>,<span class="string"> '0.8.8'</span>
<span class="title">gem</span><span class="string"> 'libnotify'</span>,<span class="string"> '0.5.9'</span></code></pre>
<p><strong>Windows</strong></p>
<pre><code><span class="title">gem</span><span class="string"> 'rb-fchange'</span>,<span class="string"> '0.0.5'</span>
<span class="title">gem</span><span class="string"> 'rb-notifu'</span>,<span class="string"> '0.0.4'</span>
<span class="title">gem</span><span class="string"> 'win32console'</span>,<span class="string"> '1.3.0'</span></code></pre>
<p>范例 Gemfile，放在 Gist:</p>
<p><a href="https://gist.github.com/2555278" target="_blank">MacOSX</a><br><a href="https://gist.github.com/2555344" target="_blank">Linux</a><br><a href="https://gist.github.com/2555343" target="_blank">Windows</a>  </p>
<p>Gemfile 配置好运行 <code>bundle install</code> ，初始化 Guard：</p>
<pre><code><span class="title">bundle</span> exec guard init rspec</code></pre>
<p>或是运行 <code>bundle install --binstubs</code>，初始化 Guard：</p>
<pre><code><span class="title">bin</span>/guard init rspec</code></pre>
<p>会产生一个 Guardfile，最上方加入此行：</p>
<pre><code><span class="title">require</span> <span class="string">'active_support/core_ext'</span></code></pre>
<p>并改动此行 <code>guard &#39;rspec&#39;, :version =&gt; 2 do</code> ：</p>
<pre><code>guard <span class="string">'rspec'</span>, <span class="symbol">:version</span> =&gt; <span class="number">2</span>, <span class="symbol">:all_after_pass</span> =&gt; <span class="keyword">false</span> <span class="keyword">do</span></code></pre>
<p>确保 Guard 不再一个失败测试通过后继续运行（加快<strong>红绿重构</strong>周期）</p>
<p>再添加：</p>
<pre><code>guard <span class="string">'rspec'</span>, <span class="symbol">:version</span> =&gt; <span class="number">2</span>, <span class="symbol">:all_after_pass</span> =&gt; <span class="keyword">false</span> <span class="keyword">do</span>
    .
    .
    .
    watch(%r{^app/controllers/(.+)<span class="number">_</span>(controller)\.rb<span class="variable">$}</span>)  <span class="keyword">do</span> |m|
      [<span class="string">"spec/routing/<span class="subst">#{m[<span class="number">1</span>]}</span>_routing_spec.rb"</span>,
       <span class="string">"spec/<span class="subst">#{m[<span class="number">2</span>]}</span>s/<span class="subst">#{m[<span class="number">1</span>]}</span>_<span class="subst">#{m[<span class="number">2</span>]}</span>_spec.rb"</span>,
       <span class="string">"spec/acceptance/<span class="subst">#{m[<span class="number">1</span>]}</span>_spec.rb"</span>,
       (m[<span class="number">1</span>][<span class="regexp">/_pages/</span>] ? <span class="string">"spec/requests/<span class="subst">#{m[<span class="number">1</span>]}</span>_spec.rb"</span> <span class="symbol">:</span> 
                         <span class="string">"spec/requests/<span class="subst">#{m[<span class="number">1</span>].singularize}</span>_pages_spec.rb"</span>)]
    <span class="keyword">end</span>
    watch(%r{^app/views/(.+)/}) <span class="keyword">do</span> |m|
      <span class="string">"spec/requests/<span class="subst">#{m[<span class="number">1</span>].singularize}</span>_pages_spec.rb"</span>
    <span class="keyword">end</span>
    .
    .
    .
<span class="keyword">end</span></code></pre>
<p>当 integration tests 及 views 有变动时，会自动运行测试。</p>
<p>这些都设置好了，启动 guard </p>
<pre><code><span class="title">bundle</span> exec guard</code></pre>
<p>或</p>
<pre><code><span class="attribute">bin/guard</code></pre>
<p>更多信息请参考：<a href="https://github.com/guard/guard" target="_blank">Guard Github 页面</a></p>
<h3>使用 Spork 来加速测试</h3>
<p>运行 rspec 很慢的原因是每次都得重加载整个 Rails 环境。Spork 测试服务器透过加载 Rails 环境，并维护一个进程池 (pool of processes) 给之后的测试使用。跟 Guard 搭配使用顺风顺水。</p>
<p>配置 Gemfile，将此行加入 <code>:test group</code>：</p>
<pre><code><span class="title">gem</span><span class="string"> 'guard-spork'</span>,<span class="string"> '0.3.2'</span>
<span class="title">gem</span><span class="string"> 'spork'</span>,<span class="string"> '0.9.0'</span></code></pre>
<p>范例 Gemfile，放在 Gist:</p>
<p><a href="https://gist.github.com/2555402" target="_blank">MacOSX</a><br><a href="https://gist.github.com/2555397" target="_blank">Linux</a><br><a href="https://gist.github.com/2555403" target="_blank">Windows</a>  </p>
<p>运行 <code>bundle install</code> 并运行 spork ：</p>
<pre><code><span class="comment">bundle</span> <span class="comment">exec</span> <span class="comment">spork</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">bootstrap</code></pre>
<p>运行 <code>bundle install --binstubs</code> 并运行 spork：</p>
<pre><code><span class="comment">spork</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">bootstrap</span> <span class="comment">#</span> <span class="comment">or</span> <span class="comment">bin/spork</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">bootstrap</code></pre>
<p>添加需加载的环境信息至 <code>spec/spec_helper.rb</code> 里的 <code>Spork.prefork</code>：</p>
<pre><code>require <span class="comment">'rubygems'</span>
require <span class="comment">'spork'</span>

Spork.prefork <span class="keyword">do</span>
  # Loading more <span class="keyword">in</span> this block will cause your tests <span class="keyword">to</span> run faster. However, 
  # <span class="keyword">if</span> you change any configuration <span class="keyword">or</span> code from libraries loaded here, you<span class="comment">'ll</span>
  # need <span class="keyword">to</span> restart spork <span class="keyword">for</span> it take effect.
  # This file <span class="keyword">is</span> copied <span class="keyword">to</span> spec/ when you run <span class="comment">'rails generate rspec:install'</span>
  ENV[<span class="string">"RAILS_ENV"</span>] ||= <span class="comment">'test'</span>
  require File.expand_path(<span class="string">"../../config/environment"</span>, __FILE__)
  require <span class="comment">'rspec/rails'</span>
  require <span class="comment">'rspec/autorun'</span>

  # Requires supporting ruby files <span class="keyword">with</span> custom matchers <span class="keyword">and</span> macros, etc,
  # <span class="keyword">in</span> spec/support/ <span class="keyword">and</span> its subdirectories.
  Dir[Rails.root.<span class="built_in">join</span>(<span class="string">"spec/support/**/*.rb"</span>)].<span class="keyword">each</span> {|f| require f}

  RSpec.configure <span class="keyword">do</span> |config|
    # == Mock Framework
    #
    # <span class="keyword">If</span> you prefer <span class="keyword">to</span> use mocha, flexmock <span class="keyword">or</span> RR, uncomment the appropriate line:
    #
    # config.mock_with :mocha
    # config.mock_with :flexmock
    # config.mock_with :rr
    config.mock_with :rspec

    # Remove this line <span class="keyword">if</span> you<span class="comment">'re not using ActiveRecord or ActiveRecord fixtures</span>
    config.fixture_path = <span class="string">"#{::Rails.root}/spec/fixtures"</span>

    # <span class="keyword">If</span> you<span class="comment">'re not using ActiveRecord, or you'd prefer not to run each of your</span>
    # examples within a transaction, remove the following line <span class="keyword">or</span> assign <span class="literal">false</span>
    # instead of <span class="literal">true</span>.
    config.use_transactional_fixtures = <span class="literal">true</span>

    # <span class="keyword">If</span> <span class="literal">true</span>, the base <span class="keyword">class</span> of anonymous controllers will be inferred
    # automatically. This will be the <span class="keyword">default</span> behavior <span class="keyword">in</span> future versions of
    # rspec-rails.
    config.infer_base_class_for_anonymous_controllers = <span class="literal">false</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

Spork.each_run <span class="keyword">do</span>
  # This code will be run <span class="keyword">each</span> <span class="built_in">time</span> you run your specs.

<span class="keyword">end</span></code></pre>
<p>启动 Spork 服务器：</p>
<p>之前使用 <code>bundle install</code>：</p>
<p><code>bundle exec spork</code> </p>
<p>之前使用 <code>bundle install --binstubs</code></p>
<p><code>bin/spork</code></p>
<p>加入此行至 <code>.rspec</code> ，让 RSpec 缺省使用 spork：</p>
<pre><code><span class="literal">-</span><span class="literal">-</span><span class="comment">drb</code></pre>
<p><strong>提示</strong> ：</p>
<p>如果改动了 <code>routes.rb</code> 需重启 Spork 服务器，如果你觉得测试是对的，但是失败了，也可以重启 Spork 服务器试试看。</p>
<p>更多信息请参考 <a href="https://github.com/sporkrb/spork" target="_blank">Spork Github 页面</a></p>
<h3>Guard 搭配 Spork</h3>
<p>有了 Guard 与 Spork 以后，让它们合体：</p>
<pre><code><span class="title">bundle</span> exec guard init spork
<span class="title">bin</span>/guard init spork</code></pre>
<p>加入此行至 Guardfile：</p>
<pre><code>guard <span class="string">'spork'</span>, <span class="symbol">:rspec_env</span> =&gt; { <span class="string">'RAILS_ENV'</span> =&gt; <span class="string">'test'</span> } <span class="keyword">do</span>
  watch(<span class="string">'config/application.rb'</span>)
  watch(<span class="string">'config/environment.rb'</span>)
  watch(%r{^config/environments/.+\.rb<span class="variable">$}</span>)
  watch(%r{^config/initializers/.+\.rb<span class="variable">$}</span>)
  watch(<span class="string">'Gemfile'</span>)
  watch(<span class="string">'Gemfile.lock'</span>)
  watch(<span class="string">'spec/spec_helper.rb'</span>)
  watch(<span class="string">'test/test_helper.rb'</span>)
  watch(<span class="string">'spec/support/'</span>)
<span class="keyword">end</span>

guard <span class="string">'rspec'</span>, <span class="symbol">:version</span> =&gt; <span class="number">2</span>, <span class="symbol">:all_after_pass</span> =&gt; <span class="keyword">false</span>, <span class="symbol">:cli</span> =&gt; <span class="string">'--drb'</span> <span class="keyword">do</span>
  .
  .
  .
<span class="keyword">end</span></code></pre>
<p>现在全都设定好了，以后只要</p>
<p><code>bundle exec guard</code> 或 <code>bin/guard</code> </p>
<p>Guard 就会自动启动 Spork 服务器并侦测你的改动！</p>
<p>打完收工。。。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
    <a href="/archives/" class="alignleft prev">上一頁</a>
  
  
    <a href="/archives/page/3/" class="alignright next">下一頁</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignleft"><!-- 
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:lisp.es/">
  </form>
</div>

  
<div class="widget twitter">
  <h3 class="title">推文</h3>
  <ul id="tweets"></ul>
</div>

<script type="text/javascript">
var twitter_stream = ['JuanitoFatas', 5, false];
var moment_js_path = '/js/moment.min.js';
</script>
<script src="/js/twitter.js"></script>


 -->
<div class="personal-info">
  <figure>
    
      <a href="/">
        <img class="personal-photo" src="https://secure.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=420&d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png" alt="Juanito Fatas">
      </a>
    
    <figcaption>
      <h3 class=>Juanito Fatas</h3>
      <p>城市中的迷途小碼農</p>
    </figcaption>
  </figure>
  <section class="social">
    
      <a target="_blank" class="icon twitter depth" href="http://twitter.com/JuanitoFatas"></a>
    
    
    
      <a target="_blank" class="icon github depth" href="http://github.com/JuanitoFatas"></a>
    
    
      <a target="_blank" class="icon email depth" href="mailto:katehuang0320@gmail.com"></a>
    
  </section>
</div>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignright depth">
  <a class="footer-link" href="/about">About Me</a>
  <a class="footer-link" href="http://github.com/thiagopnts/hexo-persona-dark">Based on Persona Dark Theme</a> 
  &copy; - 2013 Juanito Fatas
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'juanfatas';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



<script src="//cdn.moot.it/latest/moot.min.js"></script>

</body>
</html>