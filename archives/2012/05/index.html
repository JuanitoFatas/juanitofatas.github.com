<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>彙整：2012/5 | I'm Juanito Fatas</title>
  <meta name="author" content="Juanito Fatas">
  
  <meta name="description" content="This site contains technical articles, presentations, thoughts, software, and other materials by Juanito Fatas.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="I'm Juanito Fatas"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="I'm Juanito Fatas" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
    <link rel="stylesheet" type="text/css" href="//cdn.moot.it/1/moot.css">
  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script>
  $(document).ready(function() {
    $('#sidebar').delay(400).animate({ width: '285px' }, 500, function() {
      $('.personal-info').css({display: 'table'}).hide().fadeIn(500);
    });
  });
  </script>
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-41041908-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>


<body>
  <header id="header" class="inner"><!-- <div class="alignleft">
  <h1><a href="/">I'm Juanito Fatas</a></h1>
  <h2><a href="/">C-x C-f...C-x C-s...</a></h2>
</div>
 --><!-- <nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首頁</a></li>
    
      <li><a href="/archives">彙整</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
 --></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignright"><div id="wrapper">
<h2 class="archive-title">2012/5</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-18T18:40:00.000Z"><a href="/2012/05/19/jquery-events-2/">May 19 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/19/jquery-events-2/">jQuery 事件简介（下）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>注意，若是看不到下方的图片请留言，我再换到 GFW 友好的 HOST 服务上。</p>
<p>其实下面也就一张图。。。</p>
<p>OK，现在你有了基本的事件知识，现在我们看看如何实现一个简单的 FAQ，</p>
<p>型別</p>
<p>给定一个 HTML:</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
true&lt;meta charset=utf-8&gt;
true&lt;title&gt;jQuery 事件（下）&lt;/title&gt;
true&lt;link rel="stylesheet" href="style.css"&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;dl&gt;
true&lt;dt&gt;FAQ 问题一 &lt;/dt&gt;
true&lt;dd&gt; 答案一 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题二 &lt;/dt&gt;
true&lt;dd&gt; 答案二 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题三 &lt;/dt&gt;
true&lt;dd&gt; 答案三 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题四 &lt;/dt&gt;
true&lt;dd&gt; 答案四 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题五 &lt;/dt&gt;
true&lt;dd&gt; 答案五 &lt;/dd&gt;
&lt;/dl&gt;

&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"&gt;&lt;/script&gt;
&lt;script&gt;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>以及一些简单的 CSS 样式 <strong>style.css</strong> :</p>
<figure class="highlight lang-css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="tag">body</span> <span class="rules">{
    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">960</span>px;</span></span>
    <span class="rule"><span class="attribute">margin</span>:<span class="value"> auto;</span></span>
    <span class="rule"><span class="attribute">text-align</span>:<span class="value"> center;</span></span>
<span class="rule">}</span></span>

<span class="tag">dd</span> <span class="rules">{
    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span>;</span></span>
    <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">1</span>em <span class="number">0</span>;</span></span>
<span class="rule">}</span></span>

<span class="tag">dt</span> <span class="rules">{
    <span class="rule"><span class="attribute">cursor</span>:<span class="value"> pointer;</span></span>
    <span class="rule"><span class="attribute">font-weight</span>:<span class="value"> bold;</span></span>
    <span class="rule"><span class="attribute">font-size </span>:<span class="value"> <span class="number">1.5</span>em;</span></span>
    <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">2</span>em;</span></span>
    <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#b94846</span>;</span></span>
    <span class="rule"><span class="attribute">border-bottom</span>:<span class="value"> <span class="number">2</span>px solid <span class="hexcolor">#6f2b2a</span>;</span></span>
    <span class="rule"><span class="attribute">border-top</span>:<span class="value"> <span class="number">2</span>px solid white;</span></span>
<span class="rule">}</span></span>

<span class="tag">dt</span><span class="pseudo">:first-child</span> <span class="rules">{ <span class="rule"><span class="attribute">border-top</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
<span class="tag">dt</span><span class="pseudo">:nth-last-child(2)</span> <span class="rules">{ <span class="rule"><span class="attribute">border-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>

<span class="class">.hide</span> <span class="rules">{ <span class="rule"><span class="attribute">display</span>:<span class="value"> none;</span></span><span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>注意 <code>dt</code> 下方我们用了一个较深的红色 border，上方用白色 border，来与别的区块做区别。</p>
<figure class="highlight lang-css"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="tag">dt</span><span class="pseudo">:first-child</span> <span class="rules">{ <span class="rule"><span class="attribute">border-top</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
<span class="tag">dt</span><span class="pseudo">:nth-last-child(2)</span> <span class="rules">{ <span class="rule"><span class="attribute">border-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>第一行是，最上方的 FAQ 有多馀的白色 border，因为没有上方元素，不需要加上白色来区别。</p>
<p>第二行是，最下方的 FAQ 有多馀的红色 border，因为是最后的元素，不需要加上红色来区别。</p>
<p>我用 <code>2px</code> 让它看起来更明显，实际上你可以使用 <code>1px</code>，或是你喜欢的大小。</p>
<p>你可能会使用 <code>dt:last-child</code> ，这是不对的，请参考我的这篇文章：<a href="http://blog.lisp.tw/blog/2012/05/12/nth-child-common-gotcha/">CSS 一个常见 Nth-child 的误区</a></p>
<img src="https://img.skitch.com/20120518-jgbpd1k1i2cjwt5eq7g31cf5gd.png">

<p>当我们鼠标悬停至 FAQ 标题时 (<code>dt</code>)，就显示相对应的答案 (<code>dd</code>)。</p>
<p><em>下面讲述的代码请放至 <code>&lt;/body&gt;</code> 上方的 script 标签内。</em></p>
<h2>hide() show() fadeIn() slideDown() toggle()</h2>
<p>好，现在让我们看看如何做到隐藏的效果:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);

<span class="literal">true</span>$dd.hide();
<span class="literal">true</span><span class="comment">// $dd.toggle();</span>
<span class="literal">true</span><span class="comment">// $dd.show();</span>
<span class="literal">true</span><span class="comment">// $dd.fadeIn();</span>
<span class="literal">true</span><span class="comment">// $dd.slideDown();</span>
})();
</pre></td></tr></table></figure>

<p>你可以试试看我放在注解里的代码，看看是什么效果。</p>
<blockquote>
<p>toggle() 可视变不可视、不可视变可视。</p>
</blockquote>
<p>当我们使用 <code>dd.hide()</code> 的时候，实际上 jQuery 是把 <code>dd</code> 加上 <code>style=&quot;display: none;&quot;</code></p>
<p>第二种方法是先写一个 CSS 类别 <code>.hide { display: none; }</code>，把选中的元素添加类上去：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$dd.addClass(<span class="string">'hide'</span>);
</pre></td></tr></table></figure>

<h2>filter()</h2>
<p>OK。现在我们知道如何先把答案藏起来，不过通常用户来到我们页面时，我们通常会想显示第一个问题及第一个答案：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);
<span class="literal">true</span>$dd.(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);
})();
</pre></td></tr></table></figure>

<p>filter() 函数根据你传入的选择器，返回匹配的元素。</p>
<p>这个博大精深的 <code>:nth-child(n+4)</code> 是啥？看起来好可怕！DONT PANIC! 这是 CSS3 选择器，这其实是说，我要选中由第 4 个开始的所有元素，也就是</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>&lt;dl&gt;
true&lt;dt&gt;FAQ 问题一 &lt;/dt&gt;
true&lt;dd&gt; 答案一 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题二 &lt;/dt&gt;
true&lt;dd&gt; 答案二 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题三 &lt;/dt&gt;
true&lt;dd&gt; 答案三 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题四 &lt;/dt&gt;
true&lt;dd&gt; 答案四 &lt;/dd&gt;
true&lt;dt&gt;FAQ 问题五 &lt;/dt&gt;
true&lt;dd&gt; 答案五 &lt;/dd&gt;
&lt;/dl&gt;
</pre></td></tr></table></figure>

<p>1, 2, 3, 4，选中 <code>&lt;dd&gt; 答案二 &lt;/dd&gt;</code> 以及之后所有的元素。你可以试试看 console.log 一下，看看 <code>dd.(&#39;:nth-child(n+4)&#39;)</code> 选中的是什么，你就理解了。</p>
<p>OK. 讲解到这里，差不多 HTML CSS 都讲明白了，接下来看看怎么绑定事件上元素，来实现我们想要的功能。</p>
<h2>mouseenter() siblings()</h2>
<p>先讲简单的方法：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);
<span class="literal">true</span>$dd.(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>).next().show();
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>我们给 <code>dt</code> 绑定一个 mouseenter 事件，在鼠标进入 <code>dt</code> 时，我们知道 <code>dd</code> 是 <code>dt</code> 的下一个，我们显示它：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="keyword">this</span>).next().show();
</pre></td></tr></table></figure>

<p>但是显示完我们还得隐藏它：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);
<span class="literal">true</span>$dd.(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>).next().siblings(<span class="string">'dd'</span>).hide();
truetrue$(<span class="keyword">this</span>).next().show();
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>我们鼠标移到某个特定 <code>dt</code> 时，把所有 <code>dd</code> 的 <code>siblings(&#39;dd&#39;)</code> 都隐藏起来就可以了。</p>
<p>注意到我故意使用重复的代码，让我们重构它：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);
<span class="literal">true</span>$dd.(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>)
truetruetrue.next()
truetruetruetrue.show()
truetruetruetrue.siblings(<span class="string">'dd'</span>)
truetruetruetruetrue.hide();
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>看你是要排成一行，还是像我这样有缩排，喜好问题。</p>
<p>OK. 成功拉，现在让我们加上 animation，与其隐藏，我们可以使用 <code>slideUp() slideDown()</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $dd = $(<span class="string">'dd'</span>);
<span class="literal">true</span>$dd.(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>)
truetruetrue.next()
truetruetruetrue.slideDown(<span class="number">300</span>)
truetruetruetrue.siblings(<span class="string">'dd'</span>)
truetruetruetruetrue.slideUp(<span class="number">300</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p><code>slideDown()</code>, <code>slideUp()</code> 这种函数你可以传入参数，指定毫秒数，通常 200-400 ms，看起来挺舒服的。</p>
<p>OK. 现在功能出来了，看看有没有什么可以改善的，永远记得，在 <strong>功能完整后再改进</strong> 。</p>
<p>现在我们的代码实际上只用到了一次 <code>$(&#39;dd&#39;)</code>，所以不需要将它存到变量里，节省空间：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){

<span class="literal">true</span>$(<span class="string">'dd'</span>).(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>)
truetruetrue.next()
truetruetruetrue.slideDown(<span class="number">300</span>)
truetruetruetrue.siblings(<span class="string">'dd'</span>)
truetruetruetruetrue.slideUp(<span class="number">300</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>现在看看这行代码：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="string">'dt'</span>).on(<span class="string">'mouseenter'</span>, <span class="keyword">function</span>() {
<span class="literal">true</span>...
}
</pre></td></tr></table></figure>

<p>这行代码不太好，要是咱页面有一百个 <code>dt</code>，那效能不好，最好是你给 <code>dl</code> 上一个 <code>id=&quot;FAQ&quot;</code>，将选择器改为 <code>dl#FAQ</code>，这样子每次我们只会选中 FAQ，而不会去选到其他的，在这里我们演示的关系，选中 <code>$(&#39;dl&#39;)</code> 就好了。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){

<span class="literal">true</span>$(<span class="string">'dd'</span>).(<span class="string">':nth-child(n+4)'</span>).addClass(<span class="string">'hide'</span>);

<span class="literal">true</span>$(<span class="string">'dl'</span>).on(<span class="string">'mouseenter'</span>, <span class="string">'dt'</span>, <span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>)
truetruetrue.next()
truetruetruetrue.slideDown(<span class="number">300</span>)
truetruetruetrue.siblings(<span class="string">'dd'</span>)
truetruetruetruetrue.slideUp(<span class="number">300</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>注意我在 <code>on</code> 函数里又多传了一个参数，<code>&#39;dt&#39;</code> ，这叫做 选择器字串 (slector string)。</p>
<p>现在这整行代码的意思是，当用户鼠标进入 <code>dl</code> 时，选中 <code>dl</code> 的 <code>dt</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'dl'</span>).on(<span class="string">'mouseenter'</span>, <span class="string">'dt'</span>, <span class="keyword">function</span>()
</pre></td></tr></table></figure>

<p>仅仅重构了这一下，我们省去了给所有 <code>dt</code> 加上 event listener，只给特定的 <code>dt</code> 加上 event listener，尽量养成这样子的习惯，首先写一个能动的 jQuery，想想该怎么重构，并重构它。</p>
<p>打完收工。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/19/jquery-events-2/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-18T14:11:00.000Z"><a href="/2012/05/18/jquery-events-1/">May 18 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/18/jquery-events-1/">jQuery 事件简介（上）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>什么是事件？</p>
<p>比如一个链接被按下、鼠标悬停在某元素上面，这都是事件。</p>
<p>假设今天我们想要实现，按下某个按钮套用不同的 CSS。</p>
<p>给定一个 HTML:</p>
<p>型別</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
true&lt;meta charset=utf-8&gt;
true&lt;title&gt;jQuery 事件（上）&lt;/title&gt;
true&lt;link rel="stylesheet" href="day.css"&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt; 我的网站 &lt;/h1&gt;

&lt;button&gt;Day&lt;/button&gt;
&lt;button&gt;Night&lt;/button&gt;

&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"&gt;&lt;/script&gt;
&lt;script&gt;

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>以及两个 CSS, day.css, night.css:</p>
<h4>night.css</h4>
<figure class="highlight lang-css"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="tag">body</span> <span class="rules">{
<span class="rule"><span class="attribute">truebackground</span>:<span class="value"> black;</span></span>
<span class="rule"><span class="attribute">truecolor</span>:<span class="value"> white;</span></span>
<span class="rule">}</span></span>
</pre></td></tr></table></figure>

<h4>night.css</h4>
<figure class="highlight lang-css"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="tag">body</span> <span class="rules">{
<span class="rule"><span class="attribute">truebackground</span>:<span class="value"> yellow;</span></span>
<span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>下面讲述的代码请加至 <code>&lt;/body&gt;</code> 上方的 script 标签内。</p>
<p>当按下 Day 按钮的时候要套用 day.css、按下 Night 按钮的时候要套用 night.css。</p>
<p>OK. 我们要怎么达到我们想做的功能呢？第一是我们要有一个监听按钮状态的方法，给按钮加上 event listener。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){

})();
</pre></td></tr></table></figure>

<p>首先这个奇怪的:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){

})();
</pre></td></tr></table></figure>

<p>是什么？这是一个 <strong>自调用函数</strong> (self invoke function)。</p>
<p>可以想成是这样子:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">myFunc</span><span class="params">()</span>{</span>

}

myFunc();
</pre></td></tr></table></figure>

<p>这里宣告了 <code>myFunc()</code> ，在碰到这一行： <code>myFunc();</code> 的时候才会调用。</p>
<p>所以：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){

})();
</pre></td></tr></table></figure>

<p>一但载入这个 script 时，就会调用。</p>
<p>OK. 让我们继续往下看，那要怎么加入 event listener 呢？</p>
<h2>click() 函数</h2>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrueconsole.log(<span class="string">'button was clicked!'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>这跟 jQuery 说，哈罗，去 DOM 里帮我把 button 的元素都找出来，并在按下时在 cosole 记录信息：<code>&#39;button was clicked!&#39;</code></p>
<p>你可以去浏览器试试看是否成功。</p>
<p>现在我们知道如何加入一个 click 事件，现在让我们看看如何在按下按钮时，换一个 CSS 样式表。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrueconsole.log(<span class="string">'button was clicked!'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<h2>this?</h2>
<p>现在让我们简单的看一下 this。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrueconsole.log(<span class="keyword">this</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>这里的 <code>this</code> 会参照到现在被按的这个按钮。但是要注意的是，这个 <code>this</code> 所返回的 <strong>不是</strong> 一个 jQuery 对象，仅是一个 DOM 对象，所以无法继续使用 jQuery 所提供的函数。</p>
<p>那如果我想要使用 <em>this</em> 来得到参照的对象，又想继续使用 jQuery 提供的函数呢？我们可以用 <code>$()</code> 把返回的 DOM 对象包起来：</p>
<p><code>$(this)</code> 呵呵，这样大概理解了吧？</p>
<p>有的时候，我们可能常常要用到 <code>$(this)</code> ，用到两次以上的东西，都用个变量存起来，来避免 jQuery 一直跑到 DOM 查询，假设我们一个页面有三十个按钮，一直重复的去查询 DOM 会大幅降低效能。</p>
<p>比如说上面我们改变了被参照的对象的 text()，之后又替它加上一个类，之后可能又移除那个类：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrue$(<span class="keyword">this</span>).text(...);

truetrue<span class="comment">// some code goes here...</span>
truetrue$(<span class="keyword">this</span>).addClass(...);

truetrue<span class="comment">// ...other codes</span>
truetrue$(<span class="keyword">this</span>).removeClass(...);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>可以这样子重构代码：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrue$<span class="keyword">this</span> = $(<span class="keyword">this</span>);
truetrue$<span class="keyword">this</span>.text(...);

truetrue<span class="comment">// some code goes here...</span>
truetrue$<span class="keyword">this</span>.addClass(...);

truetrue<span class="comment">// ...other codes</span>
truetrue$<span class="keyword">this</span>.removeClass(...);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p><code>$this</code> 前面的 <strong>$</strong> 号可以表明这是一个 jQuery 对象，this 可以代表是现在所参照的对象。</p>
<p>这 <code>$this</code> 称为是现在参照的对象 <code>this</code> 的缓存版本 (cached version)。</p>
<h2>attr()</h2>
<p>现在回到我们刚刚的问题，如何按下按钮时，改变 CSS 样式表：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetrue$(<span class="string">'link'</span>).attr(<span class="string">'href'</span>, <span class="string">'night.css'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>这个 <code>attr()</code> 当传入一个参数时，返回这个参数名字的属性:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">var</span> href = $(<span class="string">'link'</span>).attr(<span class="string">'href'</span>);
</pre></td></tr></table></figure>

<p>我们就可以取得一个 link 的 href 属性。</p>
<p>传入两个参数时，是替第一个参数为名的属性设值:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'link'</span>).attr(<span class="string">'href'</span>, <span class="string">'night.css'</span>);
</pre></td></tr></table></figure>

<p>OK. 现在到浏览器试试看，你会发现无论按下哪个按钮时，样式表都会换成 night.css。</p>
<p>这样不行，我们要有一个办法来指定按下 day 按钮时，换成 day.css。</p>
<p>让我们试试看：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar stylesheet = $(<span class="keyword">this</span>).text().toLowerCase();
truetrue$(<span class="string">'link'</span>).attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>这样子在按下按钮时，我们得到按下按钮的 text，并转成小写，并替换 link 的 href。</p>
<p>这样是可以工作的，但是会被按钮的 text 限制了 css 文件的名字，以及有很大的不弹性，让我们看看怎么样做的更好：</p>
<p>改动 HTML：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>&lt;button data-file="day"&gt;Day&lt;/button&gt;
&lt;button data-file="night"&gt;Night&lt;/button&gt;
</pre></td></tr></table></figure>

<p>加上 <code>data-file</code> 属性。</p>
<p>也可以自定义属性，只要前缀是 <code>data-</code> 即可，比如 <code>data-yourCustomAttr</code>。</p>
<p>要取得这个 <code>data-file</code>，我们可以用刚刚学过的 <code>attr()</code>，仅传入一个参数：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar stylesheet = $(<span class="keyword">this</span>).attr(<span class="string">'data-file'</span>);
truetrue$(<span class="string">'link'</span>).attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>但是 jQuery 有一个更好的方法：<code>data()</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="keyword">this</span>).data(<span class="string">'file'</span>);
</pre></td></tr></table></figure>

<p>这里因为用的是，<code>data()</code> 方法，所以不需要使用多馀的 <code>data-</code> 前缀。</p>
<p>看看这行：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'link'</span>).attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
</pre></td></tr></table></figure>

<p>每次我们按下按钮时，jQuery 都会跑到 DOM 里面去寻找符合选择器条件的元素，这样非常的没有效率，所以我们可以缓存起来：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $link = $(<span class="string">'link'</span>);
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar stylesheet = $(<span class="keyword">this</span>).attr(<span class="string">'data-file'</span>);
truetrue$link.attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>现在另一个问题来了，当前是 day.css，按下 night 按钮时，会换成 night.css，换成 night.css 再按下 night 按钮时，还是会调用这个自调用函数，并换成 night.css，这样子还是浪费资源，我们可以：</p>
<ul>
<li><p>停用当前 CSS 的按钮（day.css 就停用 day 按钮、night.css 就停用 night 按钮）</p>
</li>
<li><p>写一个判断式侦测按下按钮是否为现下的 CSS，是的话就不做任何事，不是的话替换成另一个 CSS。</p>
</li>
</ul>
<p>我们试试看第一个方法：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $link = $(<span class="string">'link'</span>);
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar $<span class="keyword">this</span> = $(<span class="keyword">this</span>);
truetruevar stylesheet = $<span class="keyword">this</span>.attr(<span class="string">'data-file'</span>);
truetrue$link.attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
truetrue$<span class="keyword">this</span>.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>这边我们缓存了用到两次的 <code>$(this)</code> : <code>$this</code>。</p>
<p>记得 <code>attr()</code> 一个参数是返回属性、两个是设值：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$<span class="keyword">this</span>.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
<span class="comment">// 等同于</span>
$<span class="keyword">this</span>.attr(<span class="string">'disabled'</span>, <span class="string">''</span>);
</pre></td></tr></table></figure>

<p>传入第二个参数是为了设值的目的。</p>
<p>你到浏览器试试看会发现一旦 disabled 以后，按钮就死了，回不去了。</p>
<h2>siblings()</h2>
<p><code>siblings()</code> 可以取得目前参照对象的 siblings (同层元素)，可以选择性的传入选择器来筛选匹配的元素。</p>
<blockquote>
<p>Get the siblings of each element in the set of matched elements, optionally filtered by a selector.</p>
</blockquote>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $link = $(<span class="string">'link'</span>);
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar $<span class="keyword">this</span> = $(<span class="keyword">this</span>);
truetruevar stylesheet = $<span class="keyword">this</span>.attr(<span class="string">'data-file'</span>);

truetrue$<span class="keyword">this</span>.siblings(<span class="string">'button'</span>).removeAttr(<span class="string">'disabled'</span>);

truetrue$link.attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);
truetrue$<span class="keyword">this</span>.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>哎呀，又发现一个可以重构的地方：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>);
<span class="keyword">var</span> stylesheet = $<span class="keyword">this</span>.attr(<span class="string">'data-file'</span>);
</pre></td></tr></table></figure>

<p>尽量使用单一个 var 来宣告变量：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>),
truetruestylesheet = $<span class="keyword">this</span>.attr(<span class="string">'data-file'</span>);
</pre></td></tr></table></figure>

<p>并把相同的代码放在一起、把 <code>$link.attr(...)</code> 移上去，这样下面那行就可以结合：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre>(<span class="keyword">function</span>(){
truevar $link = $(<span class="string">'link'</span>);
<span class="literal">true</span>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() {
truetruevar $<span class="keyword">this</span> = $(<span class="keyword">this</span>),
truetruetruetruestylesheet = $<span class="keyword">this</span>.attr(<span class="string">'data-file'</span>);

truetrue$link.attr(<span class="string">'href'</span>, stylesheet + <span class="string">'.css'</span>);

truetrue$<span class="keyword">this</span>
truetruetruetrue.siblings(<span class="string">'button'</span>).removeAttr(<span class="string">'disabled'</span>)
truetruetruetrue.removeAttr(<span class="string">'disabled'</span>);

truetrue$<span class="keyword">this</span>.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
<span class="literal">true</span>});
})();
</pre></td></tr></table></figure>

<p>如果这样是不行的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>	$<span class="keyword">this</span>
truetruetrue.siblings(<span class="string">'button'</span>).removeAttr(<span class="string">'disabled'</span>)
truetruetrue.removeAttr(<span class="string">'disabled'</span>)
truetruetrue.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
</pre></td></tr></table></figure>

<p>因为这时第三行 <code>.attr(&#39;disabled&#39;, &#39;disabled&#39;);</code> 所参照的是 <code>siblings()</code> 而不是本来按下的按钮。</p>
<h2>end() 函数</h2>
<p>如果想要这样子写的话，可以使用 jQuery 的 <code>end()</code> 函数。</p>
<blockquote>
<p>End the most recent filtering operation in the current chain and return the set of matched elements to its previous state.</p>
</blockquote>
<p>终止最近的过滤操作，并返回到先前匹配的状态：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>	$<span class="keyword">this</span>
truetruetrue.siblings(<span class="string">'button'</span>).removeAttr(<span class="string">'disabled'</span>)
truetruetruetrue.removeAttr(<span class="string">'disabled'</span>)
truetruetruetrue.end()
truetruetrue.attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);
</pre></td></tr></table></figure>

<p>再提一下，这个 <code>click()</code> 函数也可以换成 <code>on()</code> ：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>$(<span class="string">'button'</span>).click(<span class="keyword">function</span>() { ... }) <span class="comment">// 等同于</span>
$(<span class="string">'button'</span>).on(<span class="string">'click'</span>, <span class="keyword">function</span>() { ... })
</pre></td></tr></table></figure>

<p>我会建议你使用 jQuery 的 <code>on()</code> 函数，这个理由下集再谈吧。</p>
<p>有问题、讲错的欢迎下面留言发问。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/18/jquery-events-1/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T17:04:00.000Z"><a href="/2012/05/18/jquery-query-dom/">May 18 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/18/jquery-query-dom/">使用 jQuery 查询 DOM</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>哈罗，你又来看我文章了，谢谢，这篇讲的是巨基本的使用 jQuery 来查询 DOM。</p>
<p>给定一个 HTML：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="code"><pre>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
true&lt;meta charset=utf-8&gt;
true&lt;title&gt;&lt;/title&gt;
true&lt;style&gt;
trueli { color: black }
true&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class="container"&gt;
true&lt;h1&gt;Welcome to My Website &lt;/h1&gt;
true&lt;p&gt;
truetrueLorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
truetruetempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
truetruequis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
truetrueconsequat.
true&lt;/p&gt;

true&lt;ul class="emphasis"&gt;
truetrue&lt;li&gt;item 1&lt;/li&gt;
truetrue&lt;li&gt;item 2&lt;/li&gt;
truetrue&lt;li&gt;item 3&lt;/li&gt;
truetrue&lt;li&gt;item 4&lt;/li&gt;
truetrue&lt;li&gt;item 5&lt;/li&gt;
truetrue&lt;li&gt;
truetruetrue&lt;ul&gt;
truetruetruetrue&lt;li&gt;hello from the nest.&lt;/li&gt;
truetruetrue&lt;/ul
truetrue&lt;/li&gt;
true&lt;/ul&gt;
&lt;/div&gt;

&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"&gt;&lt;/script&gt;

&lt;script&gt;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>
型別

为了讲解方便，我直接使用 CDN 来引用 jQuery。之后讲述的代码请放在 <code>&lt;/body&gt;</code> 前面的 <code>&lt;script&gt;</code> 标签内。

OK! 开始！

## children() find() next() prev() first()

假设今天我们想要选中类是 emphasis 的 <code>ul</code>：

<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>);
</pre></td></tr></table></figure>

<p>上面这行：嘿，jQuery，帮我根据这个 CSS 选择器 <code>ul.emphasis</code> 去 DOM 把符合条件的找出来。</p>
<p>取出 <code>ul</code> 的第一个 <code>li</code> ，并添加绿色：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).css(<span class="string">'color'</span>, <span class="string">'green'</span>);
</pre></td></tr></table></figure>

<p>这等同于 CSS:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>ul.emphasis &gt; li { color: green; }
</pre></td></tr></table></figure>

<p><strong>注意</strong> 这个 <code>&gt;</code> 在这边起的作用，这说明了我们只选中第一阶层的小孩，direct children。</p>
<p>试试看这个代码</p>
<p>你会发现嵌套的那个 ul li 是黑色，不是绿色。这样应该明白 direct children 了吧。</p>
<p>你也可以使用 jQuery 的 <code>find</code> 来找到：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).find(<span class="string">'li'</span>).css(<span class="string">'color'</span>, <span class="string">'green'</span>);
</pre></td></tr></table></figure>

<p>但要注意的是，这会从 <code>ul.emphasis</code> 搜寻所有的 li (all descendent)，等同于 CSS 的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>ul.emphasis li { color: green; }
</pre></td></tr></table></figure>

<p>好，现在我们在 <code>style</code> 标签内添加一个样式：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>.emphasis { color: green; }
</pre></td></tr></table></figure>

<p>并移除刚刚那行代码。</p>
<p>现在我们想替 <code>ul.emphasis</code> 的第一个 <code>li</code> 加上类名的办法来上色，该怎么做呢？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:nth-child(1)'</span>).addClass(<span class="string">'emphasis'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).find(<span class="string">'li:nth-child(1)'</span>).addClass(<span class="string">'emphasis'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>你可能会说，干嘛不用 CSS 就好了，因为使用 jQuery 的话，这些新潮的 CSS3 选择器可以支援 IE6+。</p>
<p>都是万恶的 IE 害的，呜呜。。。</p>
<p>注意这行代码内的选择器：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>不是 CSS 的选择器，而是 jQuery 提供的 Helper。如果有自带的 CSS 选择器可用的话，就使用 CSS 选择器，再来才是使用 jQuery 提供的 Helper。因为这比使用 jQuery 提供的来得快一点点。</p>
<p>刚刚那行代码，使用 CSS 有的选择器：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>好，那 jQuery 还有别的方法可用吗，有：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).first().addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>我们用了一个 jQuery 提供的 <code>first()</code>，作用一样。</p>
<p>那想选中第二个 <code>li</code> (item2) 呢，并把文字改为 Hello from jQuery？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li:nth-child(2)'</span>).text(<span class="string">'Hello from jQuery'</span>);
<span class="comment">// 或是</span>
$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>注意到，<code>eq(1)</code>，因为 Javascript 跟大多数程序语言一样是 <strong>零索引的</strong> ，从零开始数。</p>
<p>好如果我想要先选中 item2，再往后一个，该怎么写呢：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>这串长不拉机的东东有个术语叫做 <em>chaining</em> ，它能这么干的原因是每一个调用都返回一个 jQuery 对象。</p>
<p>但是别 chian 的太长了。</p>
<p>有 <code>next()</code> 也有 <code>prev()</code> 。</p>
<p>一个要写出 jQuery 的秘诀是写之前先念一遍，再直观地写出来，大部分都是对的哈哈。</p>
<p>不过这个贼长的 jQuery 你一般都会写成：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);
<span class="comment">// better</span>
$(<span class="string">'ul.emphasis li:nth-child(2)'</span>).text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<p>chaining 比较慢，代码也比较长，但你还是会需要动态地使用 chaining。</p>
<p>这么长的代码也可以这样缩排：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>$(<span class="string">'ul.emphasis'</span>).children(<span class="string">'li'</span>).eq(<span class="number">1</span>).next().text(<span class="string">'Hello from jQuery'</span>);

<span class="comment">// 等同于</span>
$(<span class="string">'ul.emphasis'</span>)
truetrue.children(<span class="string">'li'</span>)
truetruetrue.eq(<span class="number">1</span>)
truetruetrue.next().text(<span class="string">'Hello from jQuery'</span>);
</pre></td></tr></table></figure>

<h2>parent() parents() closest()</h2>
<p>HTML 实际上就是一个语法树，不懂语法树就想成家庭树，有爷爷奶奶老爸老妈儿子女儿孙子孙女。</p>
<p>好，看个例子，今天我们想要移除 <code>li</code> 的父节点的类别</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent().removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>也可以显式指定要找的 parent 的类型：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent(<span class="string">'ul'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>你可以使用浏览器的开发工具查看源代码来检查是否移除成功。</p>
<p>现在让我们加入一个新样式：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>.container { color: green; }
</pre></td></tr></table></figure>

<p>刷新页面，整面绿油油。如果我不想要整片绿油油，我想要移除 parent 的类：container，</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parent(<span class="string">'.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>刷新页面，擦，没作用，这是因为这跟 direct children 一样，只会找到上一层的 parent，如果我把 parent 换成：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parents(<span class="string">'.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>注意那个 <strong>s</strong> ，这样就会像 <code>find</code> 一样，一直往上找。</p>
<p>你也可以更具体的说，你要移除的是这个 <code>div.container</code> 元素:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).parents(<span class="string">'div.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>而这行代码等同于：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(li).closest(<span class="string">'div.container'</span>).removeClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>让我们到 <a href="http://api.jquery.com/">http://api.jquery.com/</a> 查查这个函数是干嘛使的。</p>
<h2>.closest()</h2>
<blockquote>
<p>Get the first element that matches the selector, beginning at the current element and progressing up through the DOM tree.</p>
</blockquote>
<p>我们这个例子是，从 <code>$(li)</code> 开始往上爬 DOM 树，寻找第一个匹配 <code>(&#39;div.container&#39;)</code> 的元素。</p>
<h2>.removeClass()</h2>
<blockquote>
<p>Remove a single class, multiple classes, or all classes from each element in the set of matched elements.</p>
</blockquote>
<p>移除匹配元素集合中的每一个元素的单一、多个或整个类别。</p>
<h2>parents() 与 closest() 的差异？</h2>
<p>其实是一个微妙的差异，你可以研读一下 API，或是这次我直接跟你说了吧：</p>
<p><code>parents()</code> 会根据选择器条件，往上爬树，找出所有符合的。</p>
<p><code>closest()</code> 只会根据选择器条件，找到最近符合的那一个。</p>
<p>查询 API 与源代码是学习 jQuery 的不二法门。</p>
<p>本篇结束。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/18/jquery-query-dom/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T16:31:00.000Z"><a href="/2012/05/18/jquery-intro-2/">May 18 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/18/jquery-intro-2/">jQuery 1.7 介绍（下）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>建议不要看我写的文章，赶快到这里学会时下最火最流行的 jQuery!</p>
<p><a href="http://tutsplus.com/course/30-days-to-learn-jquery/">30 天学会 jQuery</a></p>
<h2>＄号</h2>
<p>我希望你还记得 <code>$</code> 号是什么：</p>
<p>型別</p>
<pre><code>window<span class="preprocessor">.jQuery</span> = window.$ = jQuery<span class="comment">;</span>
</code></pre>
<p>拿来引用 jQuery 函数的快捷方式。</p>
<p>首先讲 jQuery 之前，假定我们有一个 HTML 文件：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
true&lt;meta charset=utf-8&gt;
true&lt;title&gt;&lt;/title&gt;
true&lt;style&gt;
true.emphasis { font-weight: bold;}
true&lt;/style&gt;
true&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"&gt;&lt;/script&gt;
true&lt;script&gt;

true&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
true&lt;li&gt;hello&lt;/li&gt;
true&lt;li&gt;hello 2&lt;/li&gt;
true&lt;li&gt;hello 3&lt;/li&gt;
&lt;/ul&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>下面讲述的代码请填入 <code>&lt;/head&gt;</code> 上方的 script 标签内。</p>
<p>OK. 开始。</p>
<p>假设我们要取得 <code>ul</code> 的第一个 <code>li</code>：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
</pre></td></tr></table></figure>

<p>打开你的浏览器看看，干，怎么不行，这是因为。。。</p>
<p>你的代码放在 head 标签内，下面的 HTML 都还没有载入完毕 (DOM)，就执行了这行代码，执行代码的时候，这会儿根本还没有看到 ul li 呢。</p>
<p>你可以把 <code>&lt;script&gt; ... &lt;/script&gt;</code> 搬到 <code>&lt;/body&gt;</code> 上方，这样就可以了。要是你很坚持你的代码要放在 head 标签内，没问题，使用 jQuery 的 ready 函数：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> foo = <span class="keyword">function</span>() {};
$(document).ready(foo);
</pre></td></tr></table></figure>

<p><code>$(document)</code> 叫 jQuery 去把 DOM 抓出来。</p>
<p>等到 document 载入完毕，准备好要给我们玩弄的时候，执行 <code>ready</code> 函数内的 <code>foo</code> 函数。</p>
<p>更简洁的写法、传入匿名函数、或叫回呼函数 (callback function)：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {

});
</pre></td></tr></table></figure>

<p>接下来在这个匿名函数内放入我们之前想做的事儿：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {
truetrue$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>这个 ready 函数会大概每 10 ms 去检查 DOM 准备好给我们玩弄了没，准备好了就执行里面的函数。</p>
<p>把 <code>$(document).ready()</code> 变得更简洁一点：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>好了，好奇的你又问了，这是为什么？</p>
<p>请看 <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js">jQuery 源代码</a>，搜索这个关键字 <code>jQuery.fn = jQuery.prototype = {</code></p>
<p>这下面一整段代码，说明了我们调用 jQuery 函数 <code>$()</code> 时，碰到选择器、函数、上下文时该怎么处理。</p>
<p>好，我们现在是传入了一个函数：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>看到没有，<code>$( function() { ... } )</code>，我们来找找处理传入函数的源代码，一直往下找：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">// HANDLE: $(function)</span>
<span class="comment">// Shortcut for document ready</span>
} <span class="keyword">else</span> <span class="keyword">if</span> ( jQuery.isFunction( selector ) ) {
truereturn rootjQuery.ready( selector );
}
</pre></td></tr></table></figure>

<p>阿哈，这里写的明明白白，document ready 的缩写。</p>
<p>这里的 <code>selector</code> 就是我们所传入的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
}
</pre></td></tr></table></figure>

<p>而它说:</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">if</span> ( jQuery.isFunction( selector ) ) {
truereturn rootjQuery.ready( selector );
}
</pre></td></tr></table></figure>

<p>如果传入的 <code>selector</code> 是函数的话，返回 <code>rootjQuery.ready( selector );</code></p>
<p>呵呵。。。所以这两段代码是等效的：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>$(document).ready(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});

$(<span class="keyword">function</span>() {
<span class="literal">true</span>$(<span class="string">'li:first-child'</span>).addClass(<span class="string">'emphasis'</span>);
});
</pre></td></tr></table></figure>

<p>很多人觉得使用第二种这个缩写不太好，第一种的可读性比较高，这是你个人的选择，如果你知道你在干什么，两个都很好。</p>
<p>本篇结束。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/18/jquery-intro-2/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T15:43:00.000Z"><a href="/2012/05/17/jquery-intro/">May 17 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/17/jquery-intro/">jQuery 1.7 介绍（上）</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>建议不要看我写的文章，赶快到这里学会时下最火最流行的 jQuery!</p>
<p><a href="http://tutsplus.com/course/30-days-to-learn-jquery/">30 天学会 jQuery</a></p>
<h2>神马是 jQuery？</h2>
<p>地球上最受欢迎的 Javascript 函式库、软件攻城狮必备技能之一、网页看起来美妙的魔法之一。</p>
<p>2012.05.17 现在的版本是 1.7.2。</p>
<p>型別</p>
<h2>去哪里获得 jQuery</h2>
<p>通常有开发版本与生产版本 <strong>32KB</strong> ，建议本地开发使用开发版本 <strong>247KB</strong> ，使用 jQuery 时顺便研读源代码。</p>
<blockquote>
<p>开发版本：无压缩、带注释；生产版本：压缩过、不堪入目。</p>
</blockquote>
<p><a href="http://jquery.com/">jQuery 官网</a></p>
<p>jQuery CDN: <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js">1.7.2 development</a> <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">1.7.2 production</a></p>
<blockquote>
<p>不建议使用 CDN，可以参考我的不要使用 CDN 来放第三方 Javascript</p>
</blockquote>
<h2>怎么在 HTML 里面玩弄 Javascript 代码</h2>
<p>把 JS 代码放在 script 标签内即可。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>&lt;script&gt;

&lt;<span class="regexp">/script&gt;
</pre></td></tr></table></figure>

<h2>如何引用 jQuery 至你的 HTML</h2>
<p>假设我有一个 app 目录，下面有一个 js 文件夹、一个 index.html，js 目录下有一个 jquery-1.7.1.js。</p>
<p>使用 script 标签引用：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>&lt;script src="js/jquery-1.7.1.js"&gt;&lt;/script&gt;
</pre></td></tr></table></figure>

<p>使用 CDN 引用：</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"&gt;&lt;/script&gt;
</pre></td></tr></table></figure>

<p><strong>建议摆放位置</strong> <code>&lt;/body&gt;</code> 标签的正上方。</p>
<p>理由：浏览器一旦碰到 script 得载入完或下载完才会继续往下载入，所以放在 <code>&lt;/body&gt;</code> 上方可以确保你的页面先载入 HTML 以及 CSS。</p>
<h2>第一个 jQuery 代码</h2>
<h3>如何引用 jQuery?</h3>
<p>jQuery 其实就是一个函数，你可以这样子引用它：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(...)
</pre></td></tr></table></figure>

<p>好，让我们看看怎么让 jQuery 玩弄页面的 CSS。</p>
<p>假设我们有一个 HTML 页面:</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
true&lt;meta charset=utf-8&gt;
true&lt;title&gt;&lt;/title&gt;
true&lt;style&gt;
true.emphasis{ color: green; }
true&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
true&lt;li&gt;hello&lt;/li&gt;
true&lt;li&gt;hello 2&lt;/li&gt;
true&lt;li&gt;hello 3&lt;/li&gt;
&lt;/ul&gt;
&lt;script src="js/jquery-1.7.1.js"&gt;&lt;/script&gt;
&lt;script&gt;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>以下代码添加至 <code>&lt;/body&gt;</code> 上方的 script 标签。</p>
<p>要怎么样用 jQuery 来添加 CSS 样式？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>);
</pre></td></tr></table></figure>

<p>这一行的作用是，你跟 jQuery 说，帮我根据这个 CSS 选择器搜寻一下 DOM。</p>
<p>存到一个变量里，并打印到浏览器的 console 看看：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">var</span> lis = jQuery(<span class="string">'ul li'</span>);
console.log(lis);
</pre></td></tr></table></figure>

<p>阿哈，你打开浏览器、打开开发者工具，切换到 console tab，会看到</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>[&lt;li&gt;​hello​&lt;<span class="regexp">/li&gt;​, &lt;li&gt;​hello 2​&lt;/</span>li&gt;​, &lt;li&gt;​hello <span class="number">3</span>​&lt;<span class="regexp">/li&gt;​]
</pre></td></tr></table></figure>

<p><code>console.log()</code> 可以当之后调试代码的手段之一。</p>
<p>猛阿，基本上只要懂 CSS 选择器，jQuery 几乎都学会了！呵呵。。。</p>
<p>再举个例子，怎么给这些清单元素添加红色呢？</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).css(<span class="string">'color'</span>,<span class="string">'red'</span>);
</pre></td></tr></table></figure>

<blockquote>
<p>尽量把所有的样式交给 CSS 来做，你偶尔才会需要用到 jQuery 来更改样式。</p>
</blockquote>
<p>另一个例子，给这些清单元素添加 <code>style</code> 标签内的 <code>.emphasis</code> 这个类：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<h3>使用缩写引用 jQuery</h3>
<p>这一行</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p>等同于</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>$(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p>等同于</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>window.jQuery(<span class="string">'ul li'</span>).addClass(<span class="string">'.emphasis'</span>);
</pre></td></tr></table></figure>

<p><strong>你怎么知道的！？</strong></p>
<p>请看 <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js">jQuery 源代码</a>的最下方：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">// Expose jQuery to the global object</span>
window.jQuery = window.$ = jQuery;
</pre></td></tr></table></figure>

<p>呵呵，人家都写在那呢。</p>
<p>这篇就介绍到这儿吧。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/17/jquery-intro/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-17T14:06:00.000Z"><a href="/2012/05/17/parse-xml-json/">May 17 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/17/parse-xml-json/">Python 简易解析 XML JSON</a></h1>
  

    </header>
    <div class="entry depth">
      
        <h3>XML</h3>
<h4>使用轻量快速的 minidom 函式库</h4>
<p>引用 minidom:</p>
<pre><code><span class="title">from</span> xml.dom <span class="import"><span class="keyword">import</span> minidom</span>
</code></pre>
<blockquote>
<p>DOM -- Document Object Model</p>
</blockquote>
<p>minidom 有一个 parseString 函数可以解析 XML 字串。</p>
<p>型別</p>
<p>解析一个随意取名的 XML 字串，存入 x：</p>
<pre><code>x = minidom.parseString("<span class="tag">&lt;<span class="title">foo</span>&gt;</span>Lorem ipsum<span class="tag">&lt;<span class="title">children</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>1<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>2<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;<span class="title">item</span>&gt;</span>3<span class="tag">&lt;/<span class="title">item</span>&gt;</span><span class="tag">&lt;/<span class="title">children</span>&gt;</span><span class="tag">&lt;/<span class="title">foo</span>&gt;</span>")
</code></pre>
<p>x 现在是一个 xml.dom.minidom.Document instance 实例。</p>
<p><strong>注意</strong> XML 不像 HTML，严格要求每个 open 标签要有一个相应的 close 标签！</p>
<p>看看 x 有什么可以调用的属性、方法：</p>
<pre><code><span class="function"><span class="title">dir</span><span class="params">(x)</span>

[<span class="title">'ATTRIBUTE_NODE'</span>, <span class="title">'CDATA_SECTION_NODE'</span>, <span class="title">'COMMENT_NODE'</span>, <span class="title">'DOCUMENT_FRAGMENT_NODE'</span>, <span class="title">'DOCUMENT_NODE'</span>, <span class="title">'DOCUMENT_TYPE_NODE'</span>, <span class="title">'ELEMENT_NODE'</span>, <span class="title">'ENTITY_NODE'</span>, <span class="title">'ENTITY_REFERENCE_NODE'</span>, <span class="title">'NOTATION_NODE'</span>, <span class="title">'PROCESSING_INSTRUCTION_NODE'</span>, <span class="title">'TEXT_NODE'</span>, <span class="title">'__doc__'</span>, <span class="title">'__init__'</span>, <span class="title">'__module__'</span>, <span class="title">'__nonzero__'</span>, <span class="title">'_call_user_data_handler'</span>, <span class="title">'_child_node_types'</span> ... <span class="title">'standalone'</span>, <span class="title">'strictErrorChecking'</span>, <span class="title">'toprettyxml'</span>, <span class="title">'toxml'</span>, <span class="title">'unlink'</span>, <span class="title">'version'</span>, <span class="title">'writexml'</span>]
</code></pre>
<p>转回 xml:</p>
<pre><code><span class="attribute">x.toprettyxml()
</code></pre>
<p>印出来看看：</p>
<pre><code><span class="title">print</span> x.toprettyxml()
</code></pre>
<p>输出：</p>
<pre><code><span class="tag">&lt;<span class="title">foo</span>&gt;</span>
    Lorem ipsum
    <span class="tag">&lt;<span class="title">children</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            1
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            2
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
        <span class="tag">&lt;<span class="title">item</span>&gt;</span>
            3
        <span class="tag">&lt;/<span class="title">item</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">children</span>&gt;</span>
<span class="tag">&lt;/<span class="title">foo</span>&gt;</span>
</code></pre>
<p>取得第二个 item 标签内的值 2：</p>
<pre><code><span class="transposed_variable">x.</span>getElementsByTagName(<span class="string">'item'</span>)<span class="matrix">[<span class="number">1</span>].</span>childNodes<span class="matrix">[<span class="number">0</span>].</span>nodeValue
</code></pre>
<p>你可以看看 dir 里面有什么函数可以用，在 python 的直译器里面玩玩看。</p>
<h3>RSS</h3>
<p>比如说想要知道 <a href="http://www.nytimes.com/services/xml/rss/nyt/Science.xml">http://www.nytimes.com/services/xml/rss/nyt/Science.xml</a> 有几个 item：</p>
<pre><code><span class="title">from</span> xml.dom <span class="import"><span class="keyword">import</span> minidom</span>

<span class="import"><span class="keyword">import</span> urllib2</span>

<span class="title">contents</span> = urllib2.urlopen(<span class="string">"http://www.nytimes.com/services/xml/rss/nyt/Science.xml"</span>).read()

<span class="title">d</span> = minidom.parseString(contents)

<span class="title">len</span>(d.getElementsByTagName(<span class="string">"item"</span>)) # =&gt; <span class="number">38</span> on <span class="number">2012.05</span><span class="number">.17</span>
</code></pre>
<h3>JSON</h3>
<p>Javascript Object Notation</p>
<p>在 Python 用 dictionary 混 List 的形式储存 <code>{ foo: [{&quot;a&quot;: 1}, ... {&quot;c&quot;: 3}] }</code></p>
<p>使用 JSON 库：</p>
<pre><code><span class="import"><span class="keyword">import</span> json</span>
</code></pre>
<p>假设今天我们有一个 json 格式的字串 j，具有两个键 <code>mon</code> 与 <code>numbers</code>：</p>
<pre><code><span class="setting">j = <span class="value">'{<span class="string">"mon"</span>: <span class="number">1</span>, <span class="string">"numbers"</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">9.9</span>]}'</span></span>
</code></pre>
<p>载入这个 json ，存到 d 里：</p>
<pre><code><span class="setting">d = <span class="value">json.loads(j)</span></span>
</code></pre>
<p>载入后我们得到一个 python 字典（无序）：</p>
<pre><code>{<span class="string">u'mon'</span>: <span class="number">1</span>, <span class="string">u'numbers'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">9.9</span>]}
</code></pre>
<p>取出 <code>mon</code> 的值：</p>
<pre><code>d[<span class="string">'mon'</span>] <span class="comment"># =&gt; 1</span>
d[<span class="string">'numbers'</span>][2] <span class="comment"># =&gt; 9.9</span>
</code></pre>
<p>你也可以 <code>eval</code> 这个 json 格式的字串：</p>
<pre><code><span class="keyword">eval</span>(j)
<span class="comment"># =&gt; {'mon': 1, 'numbers': [1, 2, 9.9]}</span>
</code></pre>
<p><strong>永远别用 eval 来解析 json</strong> 。</p>
<p>Q: 加总 www.reddit.com 帖子的 up votes。</p>
<p>A:</p>
<figure class="highlight lang-python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre>r = urllib2.urlopen(<span class="string">"http://www.reddit.com/.json"</span>)
j = json.loads(r)

j.keys() <span class="comment"># =&gt; [u'kind', u'data']</span>
j[<span class="string">'data'</span>].keys() <span class="comment"># =&gt; [u'modhash', u'children', u'after', u'before']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>].keys() <span class="comment"># =&gt; [u'kind', u'data']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'data'</span>].keys() <span class="comment"># =&gt; [..., u'ups']</span>
j[<span class="string">'data'</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'data'</span>][<span class="string">'ups'</span>] <span class="comment"># =&gt; 7902</span>

sum(c[<span class="string">'data'</span>][<span class="string">'ups'</span>] <span class="keyword">for</span> c <span class="keyword">in</span> j[<span class="string">'data'</span>][<span class="string">'children'</span>]) <span class="comment"># =&gt; 84500</span>
</pre></td></tr></table></figure>

<p>DONE.</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/17/parse-xml-json/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-12T15:04:00.000Z"><a href="/2012/05/12/nth-child-common-gotcha/">May 12 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/12/nth-child-common-gotcha/">CSS 一个常见 nth-child 的误区</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>给定有如下的 HTML 代码片段：</p>
<p>型別</p>
<figure class="highlight lang-html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre>&lt;html&gt;
...
&lt;style&gt;
truedt {
truetrueboder-top: 1px solid white;
truetrueboder-bottom: 1px solid gray;
true}
&lt;/style&gt;
&lt;body&gt;
true&lt;dl&gt;
truetrue&lt;dt&gt;How to install&lt;/dt&gt;
truetrue&lt;dd&gt;Check ...&lt;/dd&gt;
truetrue&lt;dt&gt;How to install&lt;/dt&gt;
truetrue&lt;dd&gt;Check ...&lt;/dd&gt;
truetrue&lt;dt&gt;How to install&lt;/dt&gt;
truetrue&lt;dd&gt;Check ...&lt;/dd&gt;
truetrue&lt;dt&gt;How to install&lt;/dt&gt;
truetrue&lt;dd&gt;Check ...&lt;/dd&gt;
truetrue&lt;dt&gt;How to install&lt;/dt&gt;
truetrue&lt;dd&gt;last ...&lt;/dd&gt;
true&lt;/dl&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>假设这是一个 FAQ，我们有一个 Definition list (<code>dl</code>)，并有五个 item (<code>dt</code>)，五个 item 描述 (<code>dd</code>)，</p>
<p>每个 <code>dt</code> 的上下有边界，分别是白色、黑色。</p>
<p>今天假如我们想要第一个 <code>dt</code> 上方没有 boder，以及最后一个 <code>dt</code> 下方没有 boder，这时候 CSS 该怎么写呢？</p>
<p>我们可以使用 CSS3 的 <code>first-child</code>：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:first-child</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-top</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
</code></pre>
<p>现在你可能会想要使用 <code>last-child</code> 来把 最后一个 dd 的 boder-bottom 拿掉：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:last-child</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
</code></pre>
<p>而这样不行，因为 <code>last-child</code> 是选择 parent 的最后一个 child，这个例子里会选中：</p>
<pre><code>&lt;dd&gt;last <span class="keyword">...</span>&lt;/dd&gt;
</code></pre>
<p>那该怎么办呢？可以使用 <code>nth-last-child</code> ：</p>
<pre><code><span class="tag">dt</span><span class="pseudo">:nth-last-child(2)</span> <span class="rules">{ <span class="rule"><span class="attribute">boder-bottom</span>:<span class="value"> none;</span></span> <span class="rule">}</span></span>
</code></pre>
<p>这样子会从 <code>dl</code> 的最后一个 child 开始往上 2 个，也就是我们想要的最后一个 <code>dt</code>。</p>
<p>That&#39;s it!!!</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/12/nth-child-common-gotcha/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-12T09:33:00.000Z"><a href="/2012/05/12/dont-use-cdn-html5shiv/">May 12 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/12/dont-use-cdn-html5shiv/">不要使用 CDN 来放第三方 Javascript</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p><a href="http://code.google.com/p/html5shiv/">HTML5shiv</a> 是一个让 IE 8 启用 HTML5 元素的第三方 JS，通常 CDN 引用的链接是：</p>
<p><a href="http://html5shiv.googlecode.com/svn/trunk/html5.js">http://html5shiv.googlecode.com/svn/trunk/html5.js</a></p>
<p>不要这么做的理由：</p>
<p>型別</p>
<ol>
<li><p>没有使用 HTTP 压缩</p>
</li>
<li><p>没有 cached，通常这个文件只缓存 180 秒。</p>
</li>
<li><p>googlecode.com 不支援 partial response (可以提高效能的东东)</p>
</li>
<li><p>你连到别人的地方，无法控制什么事情会发生，说不定那哥儿们不爽了直接删掉。。。</p>
</li>
<li><p>实际上压缩后才 1200 Bytes，造成很多额外的 Overhead (DNS lookup, TCP handshake...etc.)</p>
</li>
</ol>
<p>原始文章：<a href="http://zoompf.com/blog/2012/05/html5shiv-and-serving-content-from-code-repositories">html5shiv and Serving Content From Code Repositories</a></p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/12/dont-use-cdn-html5shiv/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-10T14:35:00.000Z"><a href="/2012/05/10/python-zebra/">May 10 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/10/python-zebra/">Python 解决 Zebra 谜题</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>爱因斯坦养鱼问题的学名就叫 Zebra Puzzle。之所以叫爱因斯坦养鱼问题是为了刊登在杂志上吸引读者的注意，其实这个问题不是爱因斯坦搞的...</p>
<p>问题可以到这里看：<a href="http://en.wikipedia.org/wiki/Zebra_Puzzle">Zebra Puzzle</a></p>
<p>型別</p>
<p>首先实现了 2 个 小函数，<code>imright</code> 跟 <code>nextto</code></p>
<p>确定某房是不是在某房右边、或是两个房挨著。</p>
<p>接下来给每个房子编上号，12345，</p>
<p>然后使用了 Python 自带的排列工具 <code>itertools.permutations</code> 给出房子可能的排列。</p>
<p>接著用了一个 Python 的奇技淫巧，叫做 Generator Expression，</p>
<p>语法是：<code>(term for- 子句 (选择性) for-if- 子句)</code></p>
<p>这个 generator expression 会返回一个 Generator 对象。</p>
<p>恩，给个例子好了：</p>
<p>先定义一个算平方的函数，然后用 Generator Expression：</p>
<pre><code><span class="function"><span class="keyword">def</span> <span class="title">sqr</span><span class="params">(x)</span>:</span> <span class="keyword">print</span> <span class="string">'调用 sqr, 参数 '</span>, x; <span class="keyword">return</span> x*x

g = (sq(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> x%<span class="number">2</span>==<span class="number">0</span>)
</code></pre>
<p>这个时候如果调用 g ：</p>
<pre><code>&gt;&gt;&gt; <span class="comment">g</span>
&lt;<span class="comment">GeneratorObject</span> <span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>&gt;
</code></pre>
<p>不会去调用函数，只返回一个 Generator 对象、然而</p>
<pre><code>&gt;&gt;&gt; <span class="keyword">next</span>(g)
调用 <span class="built_in">sqr</span>, 参数 <span class="number">0</span>
<span class="number">0</span>
</code></pre>
<p>才会调用这个 Generator 所绑定的函数。。。汗。。。</p>
<p>这个问题要找，水在哪个房子被喝的，哪个房子养斑马。</p>
<p>藉由把 Constraint 移到对的地方，减少需要的计算，再搭配 Generator-exp 的特性，最后大概 0.00028 秒之类的就算好了，
本来用 嵌套 For-loop 要算 1 小时。</p>
<p>至于那个 c 函数 是拿来显示统计数据跟除错用的。</p>
<p>完整代码：</p>
<script src="https://gist.github.com/2653290.js"></script>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/10/python-zebra/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon depth"></div>
        <time class="depth" datetime="2012-05-10T14:09:00.000Z"><a href="/2012/05/10/python-for-inside/">May 10 2012</a></time>
      
      
  
    <h1 class="title depth"><a href="/2012/05/10/python-for-inside/">Python For 循环的迭代器实现</a></h1>
  

    </header>
    <div class="entry depth">
      
        <p>给定一段 Python 代码：</p>
<pre><code><span class="keyword">for</span> x <span class="keyword">in</span> items:
    <span class="built_in">print</span> x
</code></pre>
<p>这个 items 可以是字串、列表、等等，这种可以迭代的集合称之为 iterable。</p>
<p>型別</p>
<p>这个 iter 就是创一个迭代器出来，相信有学过 Java 的人都不陌生。</p>
<p>然后用一个 <code>try .. except</code> 语句包住，迭代至停为止，停时会抛出 StopIteration。</p>
<p>实际上是这样实现的：</p>
<pre><code>it = iter(items)
<span class="keyword">try</span>:
    <span class="keyword">while</span> <span class="built_in">True</span>
        x = next(it)
        <span class="keyword">print</span> x
<span class="keyword">except</span> StopIteration:
    <span class="keyword">pass</span>
</code></pre>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2012/05/10/python-for-inside/#more" class="more-link">閱讀全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<a class="moot" href="https://moot.it/i/lisp_es">
   <h1 class="title">留言</h1>
</a>
  

  <nav id="pagination">
  
  
    <a href="/archives/2012/05/page/2/" class="alignright next">下一頁</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignleft"><!-- 
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:lisp.es/">
  </form>
</div>

  
<div class="widget twitter">
  <h3 class="title">推文</h3>
  <ul id="tweets"></ul>
</div>

<script type="text/javascript">
var twitter_stream = ['JuanitoFatas', 5, false];
var moment_js_path = '/js/moment.min.js';
</script>
<script src="/js/twitter.js"></script>


 -->
<div class="personal-info">
  <figure>
    
      <a href="/">
        <img class="personal-photo" src="https://secure.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=420&d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png" alt="Juanito Fatas">
      </a>
    
    <figcaption>
      <h3 class=>Juanito Fatas</h3>
      <p>城市中的迷途小碼農</p>
    </figcaption>
  </figure>
  <section class="social">
    
      <a target="_blank" class="icon twitter depth" href="http://twitter.com/JuanitoFatas"></a>
    
    
    
      <a target="_blank" class="icon github depth" href="http://github.com/JuanitoFatas"></a>
    
    
      <a target="_blank" class="icon email depth" href="mailto:katehuang0320@gmail.com"></a>
    
  </section>
</div>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignright depth">
  <a class="footer-link" href="/about">About Me</a>
  <a class="footer-link" href="http://github.com/thiagopnts/hexo-persona-dark">Based on Persona Dark Theme</a> 
  &copy; - 2013 Juanito Fatas
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



<script src="//cdn.moot.it/latest/moot.min.js"></script>

</body>
</html>